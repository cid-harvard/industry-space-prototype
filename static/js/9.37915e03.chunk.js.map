{"version":3,"sources":["components/CanvasIndustrySpaceUMapClustersRingsClusterConvexLv2.js","pages/IndustrySpaceClustersRingsClusterConvexLv2.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","components/PercentTable.js","IS-Legends-01.png","IS-Legends-02.png","IS_how-to-read-04.png","../node_modules/d3-timer/src/timer.js","../node_modules/d3-timer/src/interval.js","../node_modules/hull.js/src/hull.js","../node_modules/hull.js/src/intersect.js","../node_modules/hull.js/src/grid.js","../node_modules/hull.js/src/format.js","../node_modules/hull.js/src/convex.js"],"names":["Tooltip","styled","div","getLines","ctx","text","maxWidth","words","split","lines","currentLine","i","length","word","measureText","width","push","data","JSON","parse","proximityNodes","naicsData","clusterMap","allProximities","node","forEach","proximity","proximityRange","d3","proximityScale","domain","range","colorMap","id","color","rootNodeRef","useRef","useState","undefined","nodeList","setNodeList","hovered","setHovered","updateSimulation","setUpdateSimulation","useEffect","rootEl","current","triggerSimulationUpdate","root","height","window","innerHeight","innerWidth","smallerSize","padding","widthMargin","heightMargin","rangeWidth","rangeHeight","allXValues","allYValues","nodes","x","y","map","n","industry6Digit","find","code","toString","Error","naics_id","label","name","topLevelParentId","datum","parent_id","parseInt","console","error","radius","parent","initial_x","initial_y","xRange","yRange","xScale","yScale","canvas","append","attr","context","getContext","simulation","force","strength","d","alphaDecay","transform","hoveredNode","highlightedNode","primaryNodes","secondaryNodes","shouldTick","update","tempData","zoom","scaleExtent","on","simulationUpdate","drawPoint","r","currentPoint","totalPoints","centerX","centerY","angle","Math","PI","cos","sin","canvasEl","dragsubject","invertX","invertY","nodeX","nodeY","dx","dy","applyX","applyY","highlightedId","save","clearRect","translate","scale","k","convexMap","coords","naics","C2","convex","lineWidth","fillStyle","polished","strokeStyle","beginPath","points","hull","lineCap","point","moveTo","lineTo","closePath","stroke","fill","arc","textAlign","textBaseline","font","reverse","t","fillText","nodeCount","String","fromCharCode","shortenedLabel","slice","trg","linkedNodes","targetNode","style","cursor","restore","call","event","node2","numPrimary","floor","numSecondary","newCoords","new_x","new_y","xDist","yDist","x_interval","y_interval","allEdgeXValues","allEdgeYValues","xBounds","yBounds","bounds","max","min","transition","duration","interval","elapsed","currentNode","ceil","stop","selected","connected","links","edges","clearSelections","initGraph","setTimeout","createForceGraph","innerHTML","tooltip","top","left","replace","ref","_arrayLikeToArray","arr","len","arr2","Array","_unsupportedIterableToArray","o","minLen","Object","prototype","constructor","from","test","_taggedTemplateLiteral","strings","raw","freeze","defineProperties","value","_slicedToArray","isArray","Symbol","iterator","_arr","_n","_d","_e","_s","_i","next","done","err","unsupportedIterableToArray","TypeError","_defineProperty","obj","key","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","apply","_objectSpread2","target","arguments","source","getOwnPropertyDescriptors","_toConsumableArray","arrayLikeToArray","iter","Root","BackButton","button","HowToReadButton","Content","NodeList","NodeListItem","$color","rgba","TableTitle","Cell","Rank","strong","SectorCell","ProximityCell","Title","h1","Empty","Circle","Label","span","EmptyImage","ModalContainer","ModalBackdrop","ModalContent","CloseButton","Table","props","showToggle","highlightedRef","containerRef","modalOpen","setModalOpen","modal","onClick","src","HowToReadPNG","alt","scrollTop","offsetTop","offsetHeight","imgSrc","PNGLegend2","PNGLegend1","title","connectedNodes","highlight","parseFloat","toFixed","backgroundColor","borderLeft","border","module","exports","taskHead","taskTail","frame","timeout","clockLast","clockNow","clockSkew","clock","performance","now","Date","setFrame","requestAnimationFrame","bind","f","clearNow","Timer","this","_call","_time","_next","wake","e","timerFlush","t0","t2","t1","time","Infinity","sleep","nap","poke","delay","clearTimeout","clearInterval","setInterval","callback","restart","total","_restart","tick","intersect","require","grid","formatUtil","convexHull","_sqLength","a","b","pow","_cos","aShifted","bShifted","sqALen","sqBLen","sqrt","_intersect","segment","pointset","seg","_bBoxAround","edge","_midPoint","innerPoints","a1Cos","a2Cos","angle1Cos","MAX_CONCAVE_ANGLE_COS","angle2Cos","MAX_SEARCH_BBOX_SIZE_PERCENT","concavity","format","maxEdgeLen","unique","lastPoint","_filterDuplicates","sort","_sortByX","toXy","concat","occupiedArea","minX","minY","maxX","maxY","_occupiedArea","maxSearchArea","pt","indexOf","cellSize","concave","_concave","maxSqEdgeLen","edgeSkipList","midPointInserted","keyInSkipList","has","scaleFactor","bBoxAround","bBoxWidth","bBoxHeight","midPoint","extendBbox","rangePoints","add","splice","removePoint","Set","fromXy","ccw","x1","y1","x2","y2","x3","y3","cw","seg1","seg2","x4","y4","Grid","_cells","_cellSize","_reverseCellSize","coordToCellNum","array","cellPoints","bbox","tlCellX","tlCellY","brCellX","brCellY","pointIdxInCell","cellX","cellY","cell","trunc","val","Function","_getXY","_getObj","_cross","upper","lower","l","pop","_upperTangent","reversed","u","_lowerTangent"],"mappings":"yrBASA,IAAMA,EAAUC,IAAOC,IAAV,KAiBb,SAASC,EAASC,EAAKC,EAAMC,GAKzB,IAJA,IAAIC,EAAQF,EAAKG,MAAM,KACnBC,EAAQ,GACRC,EAAcH,EAAM,GAEfI,EAAI,EAAGA,EAAIJ,EAAMK,OAAQD,IAAK,CACnC,IAAIE,EAAON,EAAMI,GACLP,EAAIU,YAAYJ,EAAc,IAAMG,GAAME,MAC1CT,EACRI,GAAe,IAAMG,GAErBJ,EAAMO,KAAKN,GACXA,EAAcG,GAItB,OADAJ,EAAMO,KAAKN,GACJD,EAGX,IAGMQ,EAAOC,KAAKC,MAAL,iylkBACPC,EAAiBF,KAAKC,MAAL,8w/bACjBE,EAAYH,KAAKC,MAAL,kk7cACZG,EAAaJ,KAAKC,MAAL,qowHAMbI,EAAiB,GACvB,IAAK,IAAIC,KAAQJ,EACfA,EAAeI,GAAMC,SAAQ,gBAAEC,EAAF,EAAEA,UAAF,OAAiBH,EAAeP,KAAKU,MAEpE,IAAMC,EAAiBC,IAAUL,GAC3BM,EAAiBD,MAClBE,OAAOH,GACPI,MAAM,CAAC,EAAG,MAETC,EAAW,CACf,CAAEC,GAAI,IAAKC,MAAO,WAClB,CAAED,GAAI,IAAKC,MAAO,WAClB,CAAED,GAAI,IAAKC,MAAO,WAClB,CAAED,GAAI,IAAKC,MAAO,WAClB,CAAED,GAAI,IAAKC,MAAO,WAClB,CAAED,GAAI,IAAKC,MAAO,WAClB,CAAED,GAAI,IAAKC,MAAO,WAClB,CAAED,GAAI,IAAKC,MAAO,WAClB,CAAED,GAAI,IAAKC,MAAO,YA6lBL,aACb,IAAMC,EAAcC,iBAAO,MADR,EAEaC,wBAASC,GAFtB,mBAEZC,EAFY,KAEFC,EAFE,OAGWH,wBAASC,GAHpB,mBAGZG,EAHY,KAGHC,EAHG,OAI6BL,wBAASC,GAJtC,mBAIZK,EAJY,KAIMC,EAJN,KAMnBC,qBAAU,WACR,IAAIC,EAAS,KACb,GAAIX,GAAeA,EAAYY,QAAS,CAEtC,IAAMC,EApmBa,SAACF,EAAQ7B,EAAMuB,EAAaE,GACnD,IAAMO,EAAOrB,IAAUkB,GAEjBI,EAASC,OAAOC,YAChBrC,EAASoC,OAAOE,WAAa,IAE7BC,EAAcvC,EAAQmC,EAASnC,EAAQmC,EACvCK,EAAwB,GAAdD,EACVE,GAAezC,EAAQuC,GAAe,EACtCG,GAAgBP,EAAwB,GAAdI,GAAsB,EAChDI,EAAa3C,EAAQwC,EAAUC,EAC/BG,EAAcT,EAASK,EAAUE,EAEjCG,EAAa,GACbC,EAAa,GACnB5C,EAAK6C,MAAMrC,SAAQ,YAAa,IAAXsC,EAAU,EAAVA,EAAGC,EAAO,EAAPA,EACtBJ,EAAW5C,KAAK+C,GAChBF,EAAW7C,KAAKgD,MAKlB/C,EAAK6C,MAAQ7C,EAAK6C,MAAMG,KAAI,SAAAC,GAG1B,IACMC,EAAiB9C,EAAU+C,MAAK,gBAAEC,EAAF,EAAEA,KAAF,OAAYH,EAAEjC,GAAGqC,aAAeD,KACtE,IAAKF,EACH,MAAM,IAAII,MAAM,sBAOlB,IAJA,IAAMC,EAAWL,EAAeK,SAC1BC,EAAQN,EAAeO,KACzBC,EAAmBH,EAASF,WAC5BvB,EAAU1B,EAAU+C,MAAK,SAAAQ,GAAK,OAAIA,EAAMJ,WAAaA,KACnDzB,GAAiC,OAAtBA,EAAQ8B,YAEvB9B,EAAU1B,EAAU+C,MAAK,SAAAQ,GAAK,OAAIA,EAAMJ,WAAazB,EAAQ8B,eACxB,OAAtB9B,EAAQ8B,UACrBF,EAAmB5B,EAAQ8B,UAAUP,WAC5BvB,GAAgC,OAArBA,EAAQyB,WAC5BG,EAAmB5B,EAAQyB,SAASF,YAGxC,GAAIQ,SAASH,EAAkB,IAAM,EAEnC,MADAI,QAAQC,MAAMjC,GACR,IAAIwB,MAAM,uBAxBa,IA2BxBrC,EAASF,EAASoC,MAAK,qBAAEnC,KAAe0C,KAAxCzC,MAEP,OAAO,2BACFgC,GADL,IAEEe,OA5Ba,IA6Bb/C,QACAgD,OAAQnC,EACR0B,QACAU,UAAWjB,EAAEH,EACbqB,UAAWlB,EAAEF,OAKjB,IAAMqB,EAASzD,IAAUgC,GACnB0B,EAAS1D,IAAUiC,GAEnB0B,EAAS3D,MACZE,OAAOuD,GACPtD,MAAM,CAAC,EAAIwB,EAAUC,EAAaE,IAE/B8B,EAAS5D,MACZE,OAAOwD,GACPvD,MAAM,CAAE4B,EAAa,EAAIJ,EAAUE,IAEhCgC,EAASxC,EAAKyC,OAAO,UACxBC,KAAK,QAAS5E,EAAQ,MACtB4E,KAAK,SAAUzC,EAAS,MACxB1B,OAEGoE,EAAUH,EAAOI,WAAW,MAG5BC,EAAalE,MACJmE,MAAM,SAAUnE,IAAe8B,EAAa,IAAKC,EAAc,MAC/DoC,MAAM,SAAUnE,MAAmBoE,UAAU,KAC7CD,MAAM,YAAanE,MAAkBqD,QAAO,SAASgB,GACpD,OAAmB,KAAXA,EAAEhB,QAvHE,KAuHwC3B,OAErDyC,MAAM,OAAQnE,MAAeoE,UAAS,SAAAC,GAAC,OAAIA,EAAEvE,aAAWO,IAAG,SAAAgE,GAAC,OAAIA,EAAEhE,OAClEiE,WAAW,KAEtBC,EAAYvE,IAGZwE,OAAc9D,EACd+D,OAAkB/D,EAClBgE,EAAe,GACfC,EAAiB,GACjBC,GAAa,EAEXC,EAEN,SAAmBC,GAOjB,IAAMC,EAAO/E,MAAUgF,YAAY,CAAC,GAAQ,IAAIC,GAAG,QALnD,WACEV,EAAYvE,IAASuE,UACrBW,OAKF,SAASC,EAAUC,EAAGC,EAAcC,EAAaC,EAASC,GAExD,IACIC,EADkB,EAARC,KAAKC,GAAQL,EACND,EAKrB,MAAO,CAAClD,EAHGiD,EAAIM,KAAKE,IAAIH,GAASF,EAGtBnD,EAFAgD,EAAIM,KAAKG,IAAIJ,GAASD,GAKnC,IAAMM,EAAW9F,IAAU6D,GA6G3B,SAASkC,IAGP,IAFA,IAAM5D,EAAIoC,EAAUyB,QAAQhG,IAASmC,GAC/BC,EAAImC,EAAU0B,QAAQjG,IAASoC,GAFhB,WAGZrD,GACP,IAAMa,EAAOkF,EAAS5C,MAAMnD,GACxBmH,EAAQvC,EAAO/D,EAAKuC,GACpBgE,EAAQvC,EAAOhE,EAAKwC,GAClBgE,EAAKjE,EAAI+D,EACTG,EAAKjE,EAAI+D,EAEf,GAAIC,EAAKA,EAAKC,EAAKA,EAAKzG,EAAKyD,OAASzD,EAAKyD,SAEzC6C,EAAS3B,EAAU+B,OAAOJ,GAC1BC,EAAQ5B,EAAUgC,OAAOJ,IAEnBzB,EAAa1F,SAAW2F,EAAe3F,QACvC0F,EAAalC,MAAK,SAAAF,GAAC,OAAIA,EAAEjC,KAAOT,EAAKS,OACrCsE,EAAenC,MAAK,SAAAF,GAAC,OAAIA,EAAEjC,KAAOT,EAAKS,OAE3C,MAAM,CAAN,EAAOT,IAhBJb,EAAI+F,EAAS5C,MAAMlD,OAAS,EAAGD,GAAK,IAAKA,EAAG,CAAC,IAAD,IAA5CA,GAA4C,mCA6BvD,SAASmG,IACP,IAAMsB,EAAgB/B,GAAmBA,EAAgBpE,GAAKoE,EAAgBpE,QAAKK,EASnF,GAPAsD,EAAQyC,OAERzC,EAAQ0C,UAAU,EAAG,EAAGvH,EAAOmC,GAC/B0C,EAAQ2C,UAAUpC,EAAUpC,EAAGoC,EAAUnC,GACzC4B,EAAQ4C,MAAMrC,EAAUsC,EAAGtC,EAAUsC,QAGfnG,IAAlB8F,EAA6B,CAC/B,IAAMM,EAAY,CAChB,CAAEzG,GAAI,IAAKC,MAAO,UAAWyG,OAAQ,IACrC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,IAAKC,MAAO,UAAWyG,OAAQ,IACrC,CAAE1G,GAAI,IAAKC,MAAO,UAAWyG,OAAQ,IACrC,CAAE1G,GAAI,IAAKC,MAAO,UAAWyG,OAAQ,IACrC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,IAAKC,MAAO,UAAWyG,OAAQ,IACrC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,IAAKC,MAAO,UAAWyG,OAAQ,IACrC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,IACtC,CAAE1G,GAAI,KAAMC,MAAO,UAAWyG,OAAQ,KAGxCrH,EAAWG,SAAQ,YAAkB,IAAhBmH,EAAe,EAAfA,MAAOC,EAAQ,EAARA,GACpBrH,EAAOkF,EAAS5C,MAAMM,MAAK,qBAAEnC,GAAWqC,aAAesE,EAAMtE,cAC7DwE,EAASJ,EAAUtE,MAAK,qBAAEnC,GAAWqC,aAAeuE,EAAGvE,cACzD9C,GAAQsH,GACVA,EAAOH,OAAO3H,KAAK,CAACQ,EAAKuC,EAAGvC,EAAKwC,OAKrC4B,EAAQmD,UAAY,EACpBL,EAAUjH,SAAQ,YAAsB,IAApBkH,EAAmB,EAAnBA,OAAQzG,EAAW,EAAXA,MAC1B0D,EAAQoD,UAAYC,IAAc/G,EAAO,MACzC0D,EAAQsD,YAAcD,IAAc/G,EAAO,IAC3C0D,EAAQuD,YAQR,IAAMC,EAASC,IAAKV,EAAO1E,KAAI,mCAAEF,EAAF,KAAKC,EAAL,WAAY,CAACuB,EAAOxB,GAAIyB,EAAOxB,OAAM,KACpE4B,EAAQuD,YACRvD,EAAQ0D,QAAU,QAClBF,EAAO3H,SAAQ,SAAC8H,EAAO5I,GACX,IAANA,EACFiF,EAAQ4D,OAAR,MAAA5D,EAAO,YAAW2D,IAElB3D,EAAQ6D,OAAR,MAAA7D,EAAO,YAAW2D,OAGtB3D,EAAQ8D,YACR9D,EAAQ+D,SACR/D,EAAQgE,UAEVhE,EAAQmD,UAAY,EAKlB1C,IACFT,EAAQuD,YACRvD,EAAQiE,IACNtE,EAAOc,EAAgBtC,GACvByB,EAAOa,EAAgBrC,GACvB,IAnYoB,KAmYUV,GAC9B,EACA,EAAIgE,KAAKC,IACT,GAEF3B,EAAQsD,YAAc,UACtBtD,EAAQmD,UAAY,GACpBnD,EAAQ+D,SAER/D,EAAQuD,YACRvD,EAAQiE,IACNtE,EAAOc,EAAgBtC,GACvByB,EAAOa,EAAgBrC,GACvB,IAhZoB,KAgZUV,GAC9B,EACA,EAAIgE,KAAKC,IACT,GAEF3B,EAAQ+D,SAER/D,EAAQuD,YACRvD,EAAQiE,IAAItE,EAAOc,EAAgBtC,GAAIyB,EAAOa,EAAgBrC,GAAIqC,EAAgBpB,OAAQ,EAAG,EAAIqC,KAAKC,IAAI,GAC1G3B,EAAQoD,UAAY3C,EAAgBnE,MACpC0D,EAAQgE,OACRhE,EAAQsD,YAAc,QACtBtD,EAAQ+D,SAGR/D,EAAQkE,UAAY,SACpBlE,EAAQmE,aAAe,SACvBnE,EAAQoD,UAAY,OACpBpD,EAAQoE,KAAR,6BACA7J,EAASyF,EAASS,EAAgB5B,MAAO,IAAIwF,UAAUxI,SAAQ,SAACyI,EAAGvJ,GACjEiF,EAAQuE,SAASD,EAAG3E,EAAOc,EAAgBtC,GAAIyB,EAAOa,EAAgBrC,GAAM,GAAKrD,EAAI,QAGzF,IAAIyJ,EAAY,EAChB,GAAK9D,EAAa1F,QAAW2F,EAAe3F,OAmC1C,sBAAI0F,GAAJ,YAAqBC,IAAgB9E,SAAQ,SAASwE,EAAGtF,GACvD,IAAMa,EAAOkF,EAAS5C,MAAMM,MAAK,SAAAF,GAAC,OAAIA,EAAEjC,KAAOgE,EAAEhE,MAajD,GAZA2D,EAAQuD,YACRvD,EAAQiE,IAAItE,EAAO/D,EAAKuC,GAAIyB,EAAOhE,EAAKwC,GAAIxC,EAAKyD,OAAQ,EAAG,EAAIqC,KAAKC,IAAI,GACzE3B,EAAQoD,UAAYxH,EAAKU,MACzB0D,EAAQgE,OAERhE,EAAQkE,UAAY,SACpBlE,EAAQmE,aAAe,SACvBnE,EAAQoE,KAAR,cAAsBxI,EAAKyD,OAA3B,uBACAW,EAAQoD,UAAY,QACpBpD,EAAQuE,SAASE,OAAOC,aAAa,GAAKF,KAAc7E,EAAO/D,EAAKuC,GAAIyB,EAAOhE,EAAKwC,KAG/EoC,GAAeA,EAAYnE,KAAOgE,EAAEhE,GAAI,CAC3C2D,EAAQoD,UAAY,OACpBpD,EAAQoE,KAAR,6BACA,IAAMO,EAAiBtE,EAAExB,MAAM7D,QAAU,GAAKqF,EAAExB,MAAQwB,EAAExB,MAAM+F,MAAM,EAAG,IAAM,MAC/ErK,EAASyF,EAAS2E,EAAgB,IAAIN,UAAUxI,SAAQ,SAACyI,EAAGvJ,GAC1DiF,EAAQuE,SAASD,EAAG3E,EAAO/D,EAAKuC,GAAIyB,EAAOhE,EAAKwC,GAAM,GAAKrD,EAAI,gBA3CrE,GAVA+F,EAAS5C,MAAMrC,SAAQ,SAASwE,EAAGtF,GACjCiF,EAAQuD,YACRvD,EAAQiE,IAAItE,EAAOU,EAAElC,GAAIyB,EAAOS,EAAEjC,GAAIiC,EAAEhB,OAAQ,EAAG,EAAIqC,KAAKC,IAAI,GAChE3B,EAAQoD,WAAa5C,GAClBA,EAAYnE,KAAOgE,EAAEhE,IAAMb,EAAegF,EAAYnE,IAAImC,MAAK,SAAAF,GAAC,OAAIA,EAAEuG,MAAQxE,EAAEhE,MAC/EgE,EAAE/D,MAAQ+G,IAAchD,EAAE/D,MAAO,MACrC0D,EAAQgE,UAINxD,EAAa,CACf,IAAMsE,EAAc,CAACtE,GACrBhF,EAAegF,EAAYnE,IAAIR,SAAQ,SAAS,GAAQ,IAAPgJ,EAAM,EAANA,IACzCE,EAAajE,EAAS5C,MAAMM,MAAK,qBAAEnC,KAAewI,KACxD7E,EAAQuD,YACRvD,EAAQ4D,OAAOjE,EAAOa,EAAYrC,GAAIyB,EAAOY,EAAYpC,IACzD4B,EAAQ6D,OAAOlE,EAAOoF,EAAW5G,GAAIyB,EAAOmF,EAAW3G,IACvD4B,EAAQsD,YAAc,UACtBtD,EAAQ+D,SACRe,EAAY1J,KAAK2J,MAGnBD,EAAYjJ,SAAQ,SAASwE,EAAGtF,GAC1BsF,IACFL,EAAQuD,YACRvD,EAAQiE,IAAItE,EAAOU,EAAElC,GAAIyB,EAAOS,EAAEjC,GAAIiC,EAAEhB,OAAQ,EAAG,EAAIqC,KAAKC,IAAI,GAChE3B,EAAQoD,UAAY/C,EAAE/D,MACtB0D,EAAQgE,OACRhE,EAAQsD,YAAc,UACtBtD,EAAQ+D,aA8BZvD,GAAeA,EAAYnE,KAAOmG,GACpCtF,EAAO8H,MAAMC,OAAS,UACtBjF,EAAQuD,YACRvD,EAAQiE,IAAItE,EAAOa,EAAYrC,GAAIyB,EAAOY,EAAYpC,GAAIoC,EAAYnB,OAAQ,EAAG,EAAIqC,KAAKC,IAAI,GAC9F3B,EAAQsD,YAAc,QACtBtD,EAAQ+D,UAER7G,EAAO8H,MAAMC,OAAS,OAGxBjF,EAAQkF,UAoIV,OAtdApD,EACGqD,KAAKpE,GACLE,GAAG,aAAa,WACVL,IACHJ,EAAcuB,IACdjF,EAAW,CAAClB,KAAM4E,EAAauC,OAAQ,CAAC5E,EAAGnC,IAASmC,EAAGC,EAAGpC,IAASoC,KACnE8C,QAGHD,GAAG,SAAS,SAASmE,GACpB,IAAMxJ,EAAOmG,IACb,GAAInG,EAAM,CACR6E,EAAkB7E,EAClB8E,EAAe,GACfC,EAAiB,GACjBnF,EAAeI,EAAKS,IAAIR,SAAQ,WAAmBd,GAAO,IAAxB8J,EAAuB,EAAvBA,IAAK/I,EAAkB,EAAlBA,UAC/BuJ,EAAQvE,EAAS5C,MAAMM,MAAK,SAAAF,GAAC,OAAIA,EAAEjC,KAAOwI,KAChD,GAAIQ,EAAO,CACT,IAAMC,EAAa5D,KAAK6D,OAAO/J,EAAeI,EAAKS,IAAIrB,OAAS,GAAK,GAC/DwK,EAAehK,EAAeI,EAAKS,IAAIrB,OAASsK,EACtD,GAAIvK,EAAIuK,EAAY,CAClB,IAAMG,EAAYtE,EAAU,GAAIpG,EAAGuK,EAAY1J,EAAKuC,EAAGvC,EAAKwC,GAC5DiH,EAAMK,MAAQD,EAAUtH,EACxBkH,EAAMM,MAAQF,EAAUrH,EACxB,IAAMwH,EAAQH,EAAUtH,EAAIkH,EAAMlH,EAAIsH,EAAUtH,EAAIkH,EAAMlH,EAAIkH,EAAMlH,EAAIsH,EAAUtH,EAC5E0H,EAAQJ,EAAUrH,EAAIiH,EAAMjH,EAAIqH,EAAUrH,EAAIiH,EAAMjH,EAAIiH,EAAMjH,EAAIqH,EAAUrH,EAClFiH,EAAMS,WAAaF,EAAQ,GAC3BP,EAAMU,WAAaF,EAAQ,GAC3BnF,EAAatF,KAAb,2BACKiK,GADL,IAEEvJ,mBAEG,CACL,IAAM2J,EAAYtE,EAAU,GAAIpG,EAAGyK,EAAc5J,EAAKuC,EAAGvC,EAAKwC,GAC9DiH,EAAMK,MAAQD,EAAUtH,EACxBkH,EAAMM,MAAQF,EAAUrH,EACxB,IAAMwH,EAAQH,EAAUtH,EAAIkH,EAAMlH,EAAIsH,EAAUtH,EAAIkH,EAAMlH,EAAIkH,EAAMlH,EAAIsH,EAAUtH,EAC5E0H,EAAQJ,EAAUrH,EAAIiH,EAAMjH,EAAIqH,EAAUrH,EAAIiH,EAAMjH,EAAIiH,EAAMjH,EAAIqH,EAAUrH,EAClFiH,EAAMS,WAAaF,EAAQ,GAC3BP,EAAMU,WAAaF,EAAQ,GAC3BlF,EAAevF,KAAf,2BACKiK,GADL,IAEEvJ,oBAKR,IAAMkK,EAAiB,GACjBC,EAAiB,GACvB,sBAAIvF,GAAJ,YAAqBC,IAAgB9E,SAAQ,SAAAyC,GAC3C0H,EAAe5K,KAAKuE,EAAOrB,EAAEoH,QAC7BO,EAAe7K,KAAKwE,EAAOtB,EAAEqH,WAG/B,IAAMO,EAAUlK,IAAUgK,GACpBG,EAAUnK,IAAUiK,GACpBG,EAAS,CACb,CAACF,EAAQ,GAAIC,EAAQ,IACrB,CAACD,EAAQ,GAAIC,EAAQ,KAEjB/D,EAAKgE,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC9B/D,EAAK+D,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC9BjI,GAAKiI,EAAO,GAAG,GAAKA,EAAO,GAAG,IAAM,EACpChI,GAAKgI,EAAO,GAAG,GAAKA,EAAO,GAAG,IAAM,EACpCxD,EAAQlB,KAAK2E,IAAI,EAAG3E,KAAK4E,IAAI,EAAG,GAAM5E,KAAK2E,IAAIjE,EAAKtE,EAAYuE,EAAKtE,KACrE4E,EAAY,CAACxH,EAAQ,EAAIyH,EAAQzE,EAAGb,EAAS,EAAIsF,EAAQxE,GAE/D0D,EAASyE,aACJC,SAAS,KACTrB,KAAMpE,EAAKR,UAAWvE,IAAgB2G,UAAUA,EAAU,GAAGA,EAAU,IAAIC,MAAMA,IAEtF,IAAM0B,EAAImC,aAAS,SAASC,GAC1B9F,GAAa,EACb,sBAAIF,GAAJ,YAAqBC,IAAgB9E,SAAQ,SAAAyC,GAC3C,IAAMqI,EAAc7F,EAAS5C,MAAMM,MAAK,SAAA6B,GAAC,OAAIA,EAAEhE,KAAOiC,EAAEjC,MACpDqF,KAAKkF,KAAKD,EAAYxI,KAAOuD,KAAKkF,KAAKD,EAAYjB,OACrDiB,EAAYxI,EAAIwI,EAAYjB,OAE5B9E,GAAa,EACb+F,EAAYxI,EAAIwI,EAAYxI,EAAIwI,EAAYjB,MACxCiB,EAAYxI,EAAIwI,EAAYb,WAC5Ba,EAAYxI,EAAIwI,EAAYb,YAE9BpE,KAAKkF,KAAKD,EAAYvI,KAAOsD,KAAKkF,KAAKD,EAAYhB,OACrDgB,EAAYvI,EAAIuI,EAAYhB,OAE5B/E,GAAa,EACb+F,EAAYvI,EAAIuI,EAAYvI,EAAIuI,EAAYhB,MACxCgB,EAAYvI,EAAIuI,EAAYZ,WAC5BY,EAAYvI,EAAIuI,EAAYZ,eAGpC7E,MACKN,GAAc8F,EAAU,MAC3BpC,EAAEuC,SAEH,IACHjK,EAAY,CACVkK,SAAUlL,EACVmL,UAAU,GAAD,mBAAMrG,GAAN,YAAuBC,MAElC7D,EAAW,CAAClB,UAAMc,EAAWqG,OAAQ,CAAC5E,EAAGnC,IAASmC,EAAGC,EAAGpC,IAASoC,KAEnE8C,OA+BJhB,EAAWhC,MAAM4C,EAAS5C,OACf+C,GAAG,OAAQC,GAEtBhB,EAAWC,MAAM,QACN6G,MAAMlG,EAASmG,OA4UnB,CAAC7J,wBAjIwB,SAACxB,GAC/B,GAAIA,EAAM,CACR6E,EAAkB7E,EAClB8E,EAAe,GACfC,EAAiB,GACjBnF,EAAeI,EAAKS,IAAIR,SAAQ,WAAmBd,GAAO,IAAxB8J,EAAuB,EAAvBA,IAAK/I,EAAkB,EAAlBA,UAC/BuJ,EAAQvE,EAAS5C,MAAMM,MAAK,SAAAF,GAAC,OAAIA,EAAEjC,KAAOwI,KAChD,GAAIQ,EAAO,CACT,IAAMC,EAAa5D,KAAK6D,OAAO/J,EAAeI,EAAKS,IAAIrB,OAAS,GAAK,GAC/DwK,EAAehK,EAAeI,EAAKS,IAAIrB,OAASsK,EACtD,GAAIvK,EAAIuK,EAAY,CAClB,IAAMG,EAAYtE,EAAU,GAAIpG,EAAGuK,EAAY1J,EAAKuC,EAAGvC,EAAKwC,GAC5DiH,EAAMK,MAAQD,EAAUtH,EACxBkH,EAAMM,MAAQF,EAAUrH,EACxB,IAAMwH,EAAQH,EAAUtH,EAAIkH,EAAMlH,EAAIsH,EAAUtH,EAAIkH,EAAMlH,EAAIkH,EAAMlH,EAAIsH,EAAUtH,EAC5E0H,EAAQJ,EAAUrH,EAAIiH,EAAMjH,EAAIqH,EAAUrH,EAAIiH,EAAMjH,EAAIiH,EAAMjH,EAAIqH,EAAUrH,EAClFiH,EAAMS,WAAaF,EAAQ,GAC3BP,EAAMU,WAAaF,EAAQ,GAC3BnF,EAAatF,KAAb,2BACKiK,GADL,IAEEvJ,mBAEG,CACL,IAAM2J,EAAYtE,EAAU,GAAIpG,EAAGyK,EAAc5J,EAAKuC,EAAGvC,EAAKwC,GAC9DiH,EAAMK,MAAQD,EAAUtH,EACxBkH,EAAMM,MAAQF,EAAUrH,EACxB,IAAMwH,EAAQH,EAAUtH,EAAIkH,EAAMlH,EAAIsH,EAAUtH,EAAIkH,EAAMlH,EAAIkH,EAAMlH,EAAIsH,EAAUtH,EAC5E0H,EAAQJ,EAAUrH,EAAIiH,EAAMjH,EAAIqH,EAAUrH,EAAIiH,EAAMjH,EAAIiH,EAAMjH,EAAIqH,EAAUrH,EAClFiH,EAAMS,WAAaF,EAAQ,GAC3BP,EAAMU,WAAaF,EAAQ,GAC3BlF,EAAevF,KAAf,2BACKiK,GADL,IAEEvJ,oBAKR,IAAMkK,EAAiB,GACjBC,EAAiB,GACvB,sBAAIvF,GAAJ,YAAqBC,IAAgB9E,SAAQ,SAAAyC,GAC3C0H,EAAe5K,KAAKuE,EAAOrB,EAAEoH,QAC7BO,EAAe7K,KAAKwE,EAAOtB,EAAEqH,WAG/B,IAAMO,EAAUlK,IAAUgK,GACpBG,EAAUnK,IAAUiK,GACpBG,EAAS,CACb,CAACF,EAAQ,GAAIC,EAAQ,IACrB,CAACD,EAAQ,GAAIC,EAAQ,KAEjB/D,EAAKgE,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC9B/D,EAAK+D,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC9BjI,GAAKiI,EAAO,GAAG,GAAKA,EAAO,GAAG,IAAM,EACpChI,GAAKgI,EAAO,GAAG,GAAKA,EAAO,GAAG,IAAM,EACpCxD,EAAQlB,KAAK2E,IAAI,EAAG3E,KAAK4E,IAAI,EAAG,GAAM5E,KAAK2E,IAAIjE,EAAKtE,EAAYuE,EAAKtE,KACrE4E,EAAY,CAACxH,EAAQ,EAAIyH,EAAQzE,EAAGb,EAAS,EAAIsF,EAAQxE,GAE/D0D,EAASyE,aACJC,SAAS,KACTrB,KAAMpE,EAAKR,UAAWvE,IAAgB2G,UAAUA,EAAU,GAAGA,EAAU,IAAIC,MAAMA,IAEtF,IAAM0B,EAAImC,aAAS,SAASC,GAC1B9F,GAAa,EACb,sBAAIF,GAAJ,YAAqBC,IAAgB9E,SAAQ,SAAAyC,GAC3C,IAAMqI,EAAc7F,EAAS5C,MAAMM,MAAK,SAAA6B,GAAC,OAAIA,EAAEhE,KAAOiC,EAAEjC,MACpDqF,KAAKkF,KAAKD,EAAYxI,KAAOuD,KAAKkF,KAAKD,EAAYjB,OACrDiB,EAAYxI,EAAIwI,EAAYjB,OAE5B9E,GAAa,EACb+F,EAAYxI,EAAIwI,EAAYxI,EAAIwI,EAAYjB,MACxCiB,EAAYxI,EAAIwI,EAAYb,WAC5Ba,EAAYxI,EAAIwI,EAAYb,YAE9BpE,KAAKkF,KAAKD,EAAYvI,KAAOsD,KAAKkF,KAAKD,EAAYhB,OACrDgB,EAAYvI,EAAIuI,EAAYhB,OAE5B/E,GAAa,EACb+F,EAAYvI,EAAIuI,EAAYvI,EAAIuI,EAAYhB,MACxCgB,EAAYvI,EAAIuI,EAAYZ,WAC5BY,EAAYvI,EAAIuI,EAAYZ,eAGpC7E,MACKN,GAAc8F,EAAU,MAC3BpC,EAAEuC,SAEH,IACHjK,EAAY,CACVkK,SAAUlL,EACVmL,UAAU,GAAD,mBAAMrG,GAAN,YAAuBC,WAGlC/D,OAAYF,GAEdwE,KAmC+BgG,gBAjCT,WACtB,IAAMlB,EAAiB,GACjBC,EAAiB,GACvBnF,EAAS5C,MAAMrC,SAAQ,SAAAyC,GACrB0H,EAAe5K,KAAKuE,EAAOrB,EAAEH,IAC7B8H,EAAe7K,KAAKwE,EAAOtB,EAAEF,IAC7BE,EAAEH,EAAIG,EAAEiB,UACRjB,EAAEF,EAAIE,EAAEkB,aAGV,IAAM0G,EAAUlK,IAAUgK,GACpBG,EAAUnK,IAAUiK,GACpBG,EAAS,CACb,CAACF,EAAQ,GAAIC,EAAQ,IACrB,CAACD,EAAQ,GAAIC,EAAQ,KAEjB/D,EAAKgE,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC9B/D,EAAK+D,EAAO,GAAG,GAAKA,EAAO,GAAG,GAC9BjI,GAAKiI,EAAO,GAAG,GAAKA,EAAO,GAAG,IAAM,EACpChI,GAAKgI,EAAO,GAAG,GAAKA,EAAO,GAAG,IAAM,EACpCxD,EAAQlB,KAAK2E,IAAI,EAAG3E,KAAK4E,IAAI,EAAG,GAAM5E,KAAK2E,IAAIjE,EAAKtE,EAAYuE,EAAKtE,KACrE4E,EAAY,CAACxH,EAAQ,EAAIyH,EAAQzE,EAAGb,EAAS,EAAIsF,EAAQxE,GAE/D0D,EAASyE,aACJC,SAAS,KACTrB,KAAMpE,EAAKR,UAAWvE,IAAgB2G,UAAUA,EAAU,GAAGA,EAAU,IAAIC,MAAMA,IACtFpC,OAAc9D,EACd+D,OAAkB/D,EAClBgE,EAAe,GACfC,EAAiB,GACjB/D,OAAYF,GACZwE,MA3eWiG,CAAU9L,GAmfzB,OAJA+L,YAAW,WACTvG,EAAOqG,oBACN,GAEIrG,EAa6BwG,CADhCnK,EAASX,EAAYY,QACoC9B,EAAMuB,EAAaE,GAC5EE,EAAoBI,GAEtB,OAAQ,WACFF,IACFA,EAAOoK,UAAY,OAGtB,CAAC/K,EAAaK,EAAaE,EAAYE,IAE1C,IAAMuK,EAAU1K,GAAWA,EAAQjB,KACjC,kBAACxB,EAAD,CACE4K,MAAO,CAACwC,IAAK3K,EAAQkG,OAAO3E,EAAGqJ,KAAM5K,EAAQkG,OAAO5E,IAEnDtB,EAAQjB,KAAKiD,MAAM6I,QAAQ7K,EAAQjB,KAAKS,GAAI,KAE7C,KAEJ,OACE,6BACGkL,EACD,yBAAKI,IAAKpL,IACV,kBAAC,IAAD,CACE2B,MAAOvB,EACPE,QAASA,EACTE,iBAAkBA,EAClBd,eAAgBA,MCzsBT,qBACb,OACE,6BACE,kBAAC,EAAD,S,gCCNS,SAAS2L,EAAkBC,EAAKC,IAClC,MAAPA,GAAeA,EAAMD,EAAI7M,UAAQ8M,EAAMD,EAAI7M,QAE/C,IAAK,IAAID,EAAI,EAAGgN,EAAO,IAAIC,MAAMF,GAAM/M,EAAI+M,EAAK/M,IAC9CgN,EAAKhN,GAAK8M,EAAI9M,GAGhB,OAAOgN,EAPT,mC,gCCAA,8CACe,SAASE,EAA4BC,EAAGC,GACrD,GAAKD,EAAL,CACA,GAAiB,kBAANA,EAAgB,OAAO,YAAiBA,EAAGC,GACtD,IAAI7J,EAAI8J,OAAOC,UAAU3J,SAASyG,KAAK+C,GAAGtD,MAAM,GAAI,GAEpD,MADU,WAANtG,GAAkB4J,EAAEI,cAAahK,EAAI4J,EAAEI,YAAYxJ,MAC7C,QAANR,GAAqB,QAANA,EAAoB0J,MAAMO,KAAKjK,GACxC,cAANA,GAAqB,2CAA2CkK,KAAKlK,GAAW,YAAiB4J,EAAGC,QAAxG,K,gCCPa,SAASM,EAAuBC,EAASC,GAKtD,OAJKA,IACHA,EAAMD,EAAQ9D,MAAM,IAGfwD,OAAOQ,OAAOR,OAAOS,iBAAiBH,EAAS,CACpDC,IAAK,CACHG,MAAOV,OAAOQ,OAAOD,OAP3B,mC,8ECIe,SAASI,EAAelB,EAAK9M,GAC1C,OCLa,SAAyB8M,GACtC,GAAIG,MAAMgB,QAAQnB,GAAM,OAAOA,EDIxB,CAAeA,IELT,SAA+BA,EAAK9M,GACjD,GAAsB,qBAAXkO,QAA4BA,OAAOC,YAAYd,OAAOP,GAAjE,CACA,IAAIsB,EAAO,GACPC,GAAK,EACLC,GAAK,EACLC,OAAK5M,EAET,IACE,IAAK,IAAiC6M,EAA7BC,EAAK3B,EAAIoB,OAAOC,cAAmBE,GAAMG,EAAKC,EAAGC,QAAQC,QAChEP,EAAK/N,KAAKmO,EAAGT,QAET/N,GAAKoO,EAAKnO,SAAWD,GAH8CqO,GAAK,IAK9E,MAAOO,GACPN,GAAK,EACLC,EAAKK,EACL,QACA,IACOP,GAAsB,MAAhBI,EAAW,QAAWA,EAAW,SAC5C,QACA,GAAIH,EAAI,MAAMC,GAIlB,OAAOH,GFnBuB,CAAqBtB,EAAK9M,IAAM,OAAA6O,EAAA,GAA2B/B,EAAK9M,IGLjF,WACb,MAAM,IAAI8O,UAAU,6IHIgF,K,gCILvF,SAASC,EAAgBC,EAAKC,EAAKlB,GAYhD,OAXIkB,KAAOD,EACT3B,OAAO6B,eAAeF,EAAKC,EAAK,CAC9BlB,MAAOA,EACPoB,YAAY,EACZC,cAAc,EACdC,UAAU,IAGZL,EAAIC,GAAOlB,EAGNiB,ECVT,SAASM,EAAQC,EAAQC,GACvB,IAAIC,EAAOpC,OAAOoC,KAAKF,GAEvB,GAAIlC,OAAOqC,sBAAuB,CAChC,IAAIC,EAAUtC,OAAOqC,sBAAsBH,GACvCC,IAAgBG,EAAUA,EAAQC,QAAO,SAAUC,GACrD,OAAOxC,OAAOyC,yBAAyBP,EAAQM,GAAKV,eAEtDM,EAAKpP,KAAK0P,MAAMN,EAAME,GAGxB,OAAOF,EAGM,SAASO,EAAeC,GACrC,IAAK,IAAIjQ,EAAI,EAAGA,EAAIkQ,UAAUjQ,OAAQD,IAAK,CACzC,IAAImQ,EAAyB,MAAhBD,UAAUlQ,GAAakQ,UAAUlQ,GAAK,GAE/CA,EAAI,EACNsP,EAAQjC,OAAO8C,IAAS,GAAMrP,SAAQ,SAAUmO,GAC9C,EAAegB,EAAQhB,EAAKkB,EAAOlB,OAE5B5B,OAAO+C,0BAChB/C,OAAOS,iBAAiBmC,EAAQ5C,OAAO+C,0BAA0BD,IAEjEb,EAAQjC,OAAO8C,IAASrP,SAAQ,SAAUmO,GACxC5B,OAAO6B,eAAee,EAAQhB,EAAK5B,OAAOyC,yBAAyBK,EAAQlB,OAKjF,OAAOgB,E,6HC7BM,SAASI,EAAmBvD,GACzC,OCJa,SAA4BA,GACzC,GAAIG,MAAMgB,QAAQnB,GAAM,OAAO,OAAAwD,EAAA,GAAiBxD,GDGzC,CAAkBA,IELZ,SAA0ByD,GACvC,GAAsB,qBAAXrC,QAA0BA,OAAOC,YAAYd,OAAOkD,GAAO,OAAOtD,MAAMO,KAAK+C,GFIvD,CAAgBzD,IAAQ,OAAA+B,EAAA,GAA2B/B,IGLvE,WACb,MAAM,IAAIgC,UAAU,wIHIwE,K,k8HIE9F,IAAM0B,EAAOlR,IAAOC,IAAV,KAUJkR,EAAanR,IAAOoR,OAAV,KAYVC,EAAkBrR,IAAOoR,OAAV,KAYfE,EAAUtR,IAAOC,IAAV,KAWPsR,EAAWvR,IAAOC,IAAV,KAMRuR,EAAexR,IAAOC,IAAV,KAMZ,gBAAEwR,EAAF,EAAEA,OAAF,OAAcA,EAAS,oBAAsBC,YAAKD,EAAQ,IAAO,IAAM,MAKvEE,EAAa3R,YAAOwR,EAAPxR,CAAH,KAOV4R,EAAO5R,IAAOC,IAAV,KAKJ4R,EAAO7R,IAAO8R,OAAV,KAIJC,EAAa/R,YAAO4R,EAAP5R,CAAH,KAGVgS,EAAgBhS,YAAO4R,EAAP5R,CAAH,KAIbiS,EAAQjS,IAAOkS,GAAV,KAQLC,EAAQnS,YAAOiS,EAAPjS,CAAH,KASLoS,EAASpS,IAAOC,IAAV,KASNoS,EAAQrS,IAAOsS,KAAV,KAILC,EAAavS,IAAOC,IAAV,KAgBVuS,EAAiBxS,IAAOC,IAAV,KAcdwS,EAAgBzS,IAAOoR,OAAV,KAQbsB,EAAe1S,IAAOC,IAAV,KAaZ0S,GAAc3S,IAAOoR,OAAV,KAuGFwB,IA3FD,SAACC,GAAW,IACjBhP,EAAgEgP,EAAhEhP,MAAOrB,EAAyDqQ,EAAzDrQ,QAASE,EAAgDmQ,EAAhDnQ,iBAAkBd,EAA8BiR,EAA9BjR,eAAgBkR,EAAcD,EAAdC,WACnDC,EAAiB5Q,iBAAO,MACxB6Q,EAAe7Q,iBAAO,MAHL,EAIWC,oBAAS,GAJpB,mBAIhB6Q,EAJgB,KAILC,EAJK,KAMjBC,EAAQF,EACZ,kBAACT,EAAD,KACE,kBAACC,EAAD,CAAeW,QAAS,kBAAMF,GAAa,MAC3C,kBAACR,EAAD,KACE,yBAAKW,IAAKC,IAAcC,IAAK,KAC7B,kBAACZ,GAAD,CAAaS,QAAS,kBAAMF,GAAa,KAAzC,UAKF,KAEJtQ,qBAAU,WACR,GAAImQ,GAAkBA,EAAejQ,SAAWkQ,GAAgBA,EAAalQ,cAAuBT,IAAZG,EAAuB,CAC7G,IAAM4D,EAAkB2M,EAAejQ,QACjBkQ,EAAalQ,QACrB0Q,UAAYpN,EAAgBqN,UAAYrN,EAAgBsN,gBAEvE,CAACX,EAAgBC,EAAcxQ,IAElC,IAAMmR,EAASb,EAAac,IAAaC,IACzC,GAAIhQ,EAAO,CAAC,IACH4I,EAAuB5I,EAAvB4I,SAAUC,EAAa7I,EAAb6I,UACXoH,EAAQrH,EAASjI,MAAM6I,QAAQZ,EAASzK,GAAI,IAC5C+R,EAAiBrH,EAAU1I,KAAI,SAACzC,EAAMb,GAAO,IAC1CsB,EAAuCT,EAAvCS,GAAIwC,EAAmCjD,EAAnCiD,MAAOvC,EAA4BV,EAA5BU,MAAOgD,EAAqB1D,EAArB0D,OAAQxD,EAAaF,EAAbE,UAC3BuS,EAAYxR,GAAWA,EAAQjB,MAAQiB,EAAQjB,KAAKS,KAAOA,EAE3D+D,EAAWkO,WAAWrS,EAAeH,GAAWyS,QAAQ,IAC9D,OACE,kBAAC1C,EAAD,CACEC,OAAQxP,EACR0I,MAAO,CAACwJ,gBAAiBH,EAAYtC,YAAKzP,EAAO,SAAOI,GACxDiL,IAAK0G,EAAYjB,OAAiB1Q,EAClC+Q,QAPY,kBAAM1Q,EAAmBA,EAAiBK,wBAAwBxB,GAAQ,MAQtFoO,IAAK3N,GAEL,kBAAC4P,EAAD,CACEjH,MAAO,CAACyJ,WAAW,aAAD,OAAenS,KAEjC,kBAAC4P,EAAD,KAAOzH,OAAOC,aAAa,IAAM3J,EAAI,KACrC,6BAAM8D,EAAM6I,QAAQrL,EAAI,MAE1B,kBAAC+P,EAAD,KAAa9M,EAAOR,MACpB,kBAACuN,EAAD,KAAgBjM,EAAhB,SAKN,OACE,kBAACmL,EAAD,KACE,kBAACC,EAAD,CAAYiC,QAHA,kBAAM1Q,EAAmBA,EAAiBmK,kBAAoB,OAG3C,4BAC/B,kBAACwE,EAAD,CAAiB+B,QAAS,kBAAMF,GAAa,KAA7C,eACA,kBAAC5B,EAAD,KACE,kBAACW,EAAD,KACE,kBAACG,EAAD,CAAQzH,MAAO,CAACwJ,gBAAiB1H,EAASxK,SAC1C,6BAAK,kBAACoQ,EAAD,2BAAL,IAAwCyB,IAE1C,kBAACvC,EAAD,CAAUjE,IAAK0F,GACb,kBAACrB,EAAD,KACE,kBAACC,EAAD,sBACA,kBAACG,EAAD,CAAYpH,MAAO,CAAC0J,OAAQ,SAA5B,UACA,kBAACrC,EAAD,qBAED+B,IAGJZ,GAIL,OACE,kBAACjC,EAAD,KACE,kBAACG,EAAD,CAAiB+B,QAAS,kBAAMF,GAAa,KAA7C,eACA,kBAAC5B,EAAD,KACE,kBAACa,EAAD,KACE,kBAACI,EAAD,KAAY,yBAAKc,IAAKM,EAAQJ,IAAK,QAGtCJ,K,mBC9QTmB,EAAOC,QAAU,IAA0B,2C,mBCA3CD,EAAOC,QAAU,IAA0B,2C,mBCA3CD,EAAOC,QAAU,IAA0B,+C,gCCA3C,IAIIC,EACAC,EALAC,EAAQ,EACRC,EAAU,EACVvI,EAAW,EAIXwI,EAAY,EACZC,EAAW,EACXC,EAAY,EACZC,EAA+B,kBAAhBC,aAA4BA,YAAYC,IAAMD,YAAcE,KAC3EC,EAA6B,kBAAXjS,QAAuBA,OAAOkS,sBAAwBlS,OAAOkS,sBAAsBC,KAAKnS,QAAU,SAASoS,GAAKvI,WAAWuI,EAAG,KAE7I,SAASL,IACd,OAAOJ,IAAaM,EAASI,GAAWV,EAAWE,EAAME,MAAQH,GAGnE,SAASS,IACPV,EAAW,EAGN,SAASW,IACdC,KAAKC,MACLD,KAAKE,MACLF,KAAKG,MAAQ,KA2Cf,SAASC,IACPhB,GAAYD,EAAYG,EAAME,OAASH,EACvCJ,EAAQC,EAAU,EAClB,KAdK,WACLM,MACEP,EAEF,IADA,IAAkBoB,EAAd7L,EAAIuK,EACDvK,IACA6L,EAAIjB,EAAW5K,EAAE0L,QAAU,GAAG1L,EAAEyL,MAAM5K,KAAK,KAAMgL,GACtD7L,EAAIA,EAAE2L,QAENlB,EAOAqB,GADF,QAGErB,EAAQ,EAWZ,WACE,IAAIsB,EAAmBC,EAAfC,EAAK1B,EAAc2B,EAAOC,IAClC,KAAOF,GACDA,EAAGR,OACDS,EAAOD,EAAGP,QAAOQ,EAAOD,EAAGP,OAC/BK,EAAKE,EAAIA,EAAKA,EAAGN,QAEjBK,EAAKC,EAAGN,MAAOM,EAAGN,MAAQ,KAC1BM,EAAKF,EAAKA,EAAGJ,MAAQK,EAAKzB,EAAWyB,GAGzCxB,EAAWuB,EACXK,EAAMF,GAtBJG,GACAzB,EAAW,GAIf,SAAS0B,IACP,IAAItB,EAAMF,EAAME,MAAOuB,EAAQvB,EAAML,EACjC4B,EA7EU,MA6ES1B,GAAa0B,EAAO5B,EAAYK,GAkBzD,SAASoB,EAAMF,GACTzB,IACAC,IAASA,EAAU8B,aAAa9B,IACxBwB,EAAOtB,EACP,IACNsB,EAAOC,MAAUzB,EAAU5H,WAAW8I,EAAMM,EAAOpB,EAAME,MAAQH,IACjE1I,IAAUA,EAAWsK,cAActK,MAElCA,IAAUwI,EAAYG,EAAME,MAAO7I,EAAWuK,YAAYJ,EAvGnD,MAwGZ7B,EAAQ,EAAGS,EAASU,KAjFxBL,EAAMxH,UAuBC,SAAe4I,EAAUJ,EAAOL,GACrC,IAAIlM,EAAI,IAAIuL,EAEZ,OADAvL,EAAE4M,QAAQD,EAAUJ,EAAOL,GACpBlM,GA1Be+D,UAAY,CAClCC,YAAauH,EACbqB,QAAS,SAASD,EAAUJ,EAAOL,GACjC,GAAwB,oBAAbS,EAAyB,MAAM,IAAIpH,UAAU,8BACxD2G,GAAgB,MAARA,EAAelB,KAASkB,IAAkB,MAATK,EAAgB,GAAKA,GACzDf,KAAKG,OAASnB,IAAagB,OAC1BhB,EAAUA,EAASmB,MAAQH,KAC1BjB,EAAWiB,KAChBhB,EAAWgB,MAEbA,KAAKC,MAAQkB,EACbnB,KAAKE,MAAQQ,EACbE,KAEF7J,KAAM,WACAiJ,KAAKC,QACPD,KAAKC,MAAQ,KACbD,KAAKE,MAAQS,IACbC,OC1CS,aAASO,EAAUJ,EAAOL,GACvC,IAAIlM,EAAI,IAAIuL,EAAOsB,EAAQN,EAC3B,OAAa,MAATA,GAAsBvM,EAAE4M,QAAQD,EAAUJ,EAAOL,GAAOlM,IAC5DA,EAAE8M,SAAW9M,EAAE4M,QACf5M,EAAE4M,QAAU,SAASD,EAAUJ,EAAOL,GACpCK,GAASA,EAAOL,EAAe,MAARA,EAAelB,KAASkB,EAC/ClM,EAAE8M,UAAS,SAASC,EAAK3K,GACvBA,GAAWyK,EACX7M,EAAE8M,SAASC,EAAMF,GAASN,EAAOL,GACjCS,EAASvK,KACRmK,EAAOL,IAEZlM,EAAE4M,QAAQD,EAAUJ,EAAOL,GACpBlM,K,gCCPT,IAAMgN,EAAYC,EAAQ,IACpBC,EAAOD,EAAQ,IACfE,EAAaF,EAAQ,IACrBG,EAAaH,EAAQ,IAqB3B,SAASI,EAAUC,EAAGC,GAClB,OAAOnQ,KAAKoQ,IAAID,EAAE,GAAKD,EAAE,GAAI,GAAKlQ,KAAKoQ,IAAID,EAAE,GAAKD,EAAE,GAAI,GAG5D,SAASG,EAAK7J,EAAG0J,EAAGC,GAChB,IAAMG,EAAW,CAACJ,EAAE,GAAK1J,EAAE,GAAI0J,EAAE,GAAK1J,EAAE,IACpC+J,EAAW,CAACJ,EAAE,GAAK3J,EAAE,GAAI2J,EAAE,GAAK3J,EAAE,IAClCgK,EAASP,EAAUzJ,EAAG0J,GACtBO,EAASR,EAAUzJ,EAAG2J,GAG1B,OAFUG,EAAS,GAAKC,EAAS,GAAKD,EAAS,GAAKC,EAAS,IAEhDvQ,KAAK0Q,KAAKF,EAASC,GAGpC,SAASE,EAAWC,EAASC,GACzB,IAAK,IAAIxX,EAAI,EAAGA,EAAIwX,EAASvX,OAAS,EAAGD,IAAK,CAC1C,IAAMyX,EAAM,CAACD,EAASxX,GAAIwX,EAASxX,EAAI,IACvC,KAAIuX,EAAQ,GAAG,KAAOE,EAAI,GAAG,IAAMF,EAAQ,GAAG,KAAOE,EAAI,GAAG,IACxDF,EAAQ,GAAG,KAAOE,EAAI,GAAG,IAAMF,EAAQ,GAAG,KAAOE,EAAI,GAAG,KAGxDlB,EAAUgB,EAASE,GACnB,OAAO,EAGf,OAAO,EA8BX,SAASC,EAAYC,GACjB,MAAO,CACHhR,KAAK4E,IAAIoM,EAAK,GAAG,GAAIA,EAAK,GAAG,IAC7BhR,KAAK4E,IAAIoM,EAAK,GAAG,GAAIA,EAAK,GAAG,IAC7BhR,KAAK2E,IAAIqM,EAAK,GAAG,GAAIA,EAAK,GAAG,IAC7BhR,KAAK2E,IAAIqM,EAAK,GAAG,GAAIA,EAAK,GAAG,KAIrC,SAASC,EAAUD,EAAME,EAAa1P,GAMlC,IALA,IAGI2P,EAAOC,EAHPnP,EAAQ,KACRoP,EAAYC,EACZC,EAAYD,EAGPjY,EAAI,EAAGA,EAAI6X,EAAY5X,OAAQD,IACpC8X,EAAQd,EAAKW,EAAK,GAAIA,EAAK,GAAIE,EAAY7X,IAC3C+X,EAAQf,EAAKW,EAAK,GAAIA,EAAK,GAAIE,EAAY7X,IAEvC8X,EAAQE,GAAaD,EAAQG,IAC5BZ,EAAW,CAACK,EAAK,GAAIE,EAAY7X,IAAKmI,KACtCmP,EAAW,CAACK,EAAK,GAAIE,EAAY7X,IAAKmI,KAEvC6P,EAAYF,EACZI,EAAYH,EACZnP,EAAQiP,EAAY7X,IAI5B,OAAO4I,EA+EX,IAAMqP,EAAwBtR,KAAKE,IAAI,IAAM,IAAMF,KAAKC,KAClDuR,EAA+B,GAErCvE,EAAOC,QApCP,SAAc2D,EAAUY,EAAWC,GAC/B,IAAIC,EAAaF,GAAa,GAExB3P,EAxJV,SAA2B+O,GAGvB,IAFA,IAAMe,EAAS,CAACf,EAAS,IACrBgB,EAAYhB,EAAS,GAChBxX,EAAI,EAAGA,EAAIwX,EAASvX,OAAQD,IAAK,CACtC,IAAMsG,EAAekR,EAASxX,GAC1BwY,EAAU,KAAOlS,EAAa,IAAMkS,EAAU,KAAOlS,EAAa,IAClEiS,EAAOlY,KAAKiG,GAEhBkS,EAAYlS,EAEhB,OAAOiS,EA8IQE,CA3InB,SAAkBjB,GACd,OAAOA,EAASkB,MAAK,SAAS7B,EAAGC,GAC7B,OAAQD,EAAE,GAAKC,EAAE,IAAQD,EAAE,GAAKC,EAAE,MAyIL6B,CAASjC,EAAWkC,KAAKpB,EAAUa,KAEpE,GAAI5P,EAAOxI,OAAS,EAChB,OAAOwI,EAAOoQ,OAAO,CAACpQ,EAAO,KAGjC,IAAMqQ,EA/GV,SAAuBtB,GAMnB,IALA,IAAIuB,EAAOrD,IACPsD,EAAOtD,IACPuD,GAAQvD,IACRwD,GAAQxD,IAEH1V,EAAIwX,EAASvX,OAAS,EAAGD,GAAK,EAAGA,IAClCwX,EAASxX,GAAG,GAAK+Y,IACjBA,EAAOvB,EAASxX,GAAG,IAEnBwX,EAASxX,GAAG,GAAKgZ,IACjBA,EAAOxB,EAASxX,GAAG,IAEnBwX,EAASxX,GAAG,GAAKiZ,IACjBA,EAAOzB,EAASxX,GAAG,IAEnBwX,EAASxX,GAAG,GAAKkZ,IACjBA,EAAO1B,EAASxX,GAAG,IAI3B,MAAO,CACHiZ,EAAOF,EACPG,EAAOF,GAwFUG,CAAc1Q,GAC7B2Q,EAAgB,CAClBN,EAAa,GAAKX,EAClBW,EAAa,GAAKX,GAGhBhQ,EAASwO,EAAWlO,GACpBoP,EAAcpP,EAAOmH,QAAO,SAASyJ,GACvC,OAAOlR,EAAOmR,QAAQD,GAAM,KAG1BE,EAAW5S,KAAKkF,KAAK,GAAKpD,EAAOxI,QAAU6Y,EAAa,GAAKA,EAAa,MAE1EU,EAjEV,SAASC,EAAStR,EAAQuR,EAAcN,EAAe3C,EAAMkD,GAGzD,IAFA,IAAIC,GAAmB,EAEd5Z,EAAI,EAAGA,EAAImI,EAAOlI,OAAS,EAAGD,IAAK,CACxC,IAAM2X,EAAO,CAACxP,EAAOnI,GAAImI,EAAOnI,EAAI,IAE9B6Z,EAAgBlC,EAAK,GAAG,GAAK,IAAMA,EAAK,GAAG,GAAK,IAAMA,EAAK,GAAG,GAAK,IAAMA,EAAK,GAAG,GAEvF,KAAIf,EAAUe,EAAK,GAAIA,EAAK,IAAM+B,GAC9BC,EAAaG,IAAID,IADrB,CAGA,IAAIE,EAAc,EACdC,EAAatC,EAAYC,GACzBsC,OAAS,EACTC,OAAU,EACVC,OAAQ,EACZ,GAEIF,GADAD,EAAavD,EAAK2D,WAAWJ,EAAYD,IAClB,GAAKC,EAAW,GACvCE,EAAaF,EAAW,GAAKA,EAAW,GAExCG,EAAWvC,EAAUD,EAAMlB,EAAK4D,YAAYL,GAAa7R,GACzD4R,UACmB,OAAbI,IAAsBf,EAAc,GAAKa,GAAab,EAAc,GAAKc,IAE/ED,GAAab,EAAc,IAAMc,GAAcd,EAAc,IAC7DO,EAAaW,IAAIT,GAGJ,OAAbM,IACAhS,EAAOoS,OAAOva,EAAI,EAAG,EAAGma,GACxB1D,EAAK+D,YAAYL,GACjBP,GAAmB,IAI3B,OAAIA,EACOH,EAAStR,EAAQuR,EAAcN,EAAe3C,EAAMkD,GAGxDxR,EAyBSsR,CACZtR,EAAQxB,KAAKoQ,IAAIuB,EAAY,GAC7Bc,EAAe3C,EAAKoB,EAAa0B,GAAW,IAAIkB,KAEpD,OAAIpC,EACO3B,EAAWgE,OAAOlB,EAASnB,GAE3BmB,I,iBC/Lf,SAASmB,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAC7B,IAAMC,GAAOD,EAAKJ,IAAOC,EAAKF,IAASG,EAAKF,IAAOG,EAAKJ,GACxD,OAAOM,EAAK,KAAWA,EAAK,GAYhCtH,EAAOC,QATP,SAAmBsH,EAAMC,GACvB,IAAMR,EAAKO,EAAK,GAAG,GAAIN,EAAKM,EAAK,GAAG,GAChCL,EAAKK,EAAK,GAAG,GAAIJ,EAAKI,EAAK,GAAG,GAC9BH,EAAKI,EAAK,GAAG,GAAIH,EAAKG,EAAK,GAAG,GAC9BC,EAAKD,EAAK,GAAG,GAAIE,EAAKF,EAAK,GAAG,GAEhC,OAAOT,EAAIC,EAAIC,EAAIG,EAAIC,EAAII,EAAIC,KAAQX,EAAIG,EAAIC,EAAIC,EAAIC,EAAII,EAAIC,IAAOX,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,KAAQN,EAAIC,EAAIC,EAAIC,EAAIC,EAAIM,EAAIC,K,iBCXlI,SAASC,EAAK9S,EAAQ8Q,GAClBxE,KAAKyG,OAAS,GACdzG,KAAK0G,UAAYlC,EACjBxE,KAAK2G,iBAAmB,EAAInC,EAE5B,IAAK,IAAIvZ,EAAI,EAAGA,EAAIyI,EAAOxI,OAAQD,IAAK,CACpC,IAAM4I,EAAQH,EAAOzI,GACfoD,EAAI2R,KAAK4G,eAAe/S,EAAM,IAC9BvF,EAAI0R,KAAK4G,eAAe/S,EAAM,IACpC,GAAKmM,KAAKyG,OAAOpY,GAIL2R,KAAKyG,OAAOpY,GAAGC,GAGvB0R,KAAKyG,OAAOpY,GAAGC,GAAGhD,KAAKuI,GAFvBmM,KAAKyG,OAAOpY,GAAGC,GAAK,CAACuF,OALJ,CACjB,IAAMgT,EAAQ,GACdA,EAAMvY,GAAK,CAACuF,GACZmM,KAAKyG,OAAOpY,GAAKwY,IAS7BL,EAAKjO,UAAY,CACbuO,WAAY,SAASzY,EAAGC,GACpB,YAA2B1B,IAAnBoT,KAAKyG,OAAOpY,SAA0CzB,IAAtBoT,KAAKyG,OAAOpY,GAAGC,GAAoB0R,KAAKyG,OAAOpY,GAAGC,GAAK,IAGnGgX,YAAa,SAASyB,GAOlB,IANA,IAAMC,EAAUhH,KAAK4G,eAAeG,EAAK,IACnCE,EAAUjH,KAAK4G,eAAeG,EAAK,IACnCG,EAAUlH,KAAK4G,eAAeG,EAAK,IACnCI,EAAUnH,KAAK4G,eAAeG,EAAK,IACnCrT,EAAS,GAENrF,EAAI2Y,EAAS3Y,GAAK6Y,EAAS7Y,IAChC,IAAK,IAAIC,EAAI2Y,EAAS3Y,GAAK6Y,EAAS7Y,IAEhC,IAAK,IAAIrD,EAAI,EAAGA,EAAI+U,KAAK8G,WAAWzY,EAAGC,GAAGpD,OAAQD,IAC9CyI,EAAOpI,KAAK0U,KAAK8G,WAAWzY,EAAGC,GAAGrD,IAK9C,OAAOyI,GAGX+R,YAAa,SAAS5R,GAMlB,IALA,IAGIuT,EAHEC,EAAQrH,KAAK4G,eAAe/S,EAAM,IAClCyT,EAAQtH,KAAK4G,eAAe/S,EAAM,IAClC0T,EAAOvH,KAAKyG,OAAOY,GAAOC,GAGvBrc,EAAI,EAAGA,EAAIsc,EAAKrc,OAAQD,IAC7B,GAAIsc,EAAKtc,GAAG,KAAO4I,EAAM,IAAM0T,EAAKtc,GAAG,KAAO4I,EAAM,GAAI,CACpDuT,EAAiBnc,EACjB,MAMR,OAFAsc,EAAK/B,OAAO4B,EAAgB,GAErBG,GAGXC,MAAO5V,KAAK4V,OAAS,SAASC,GAC1B,OAAOA,EAAMA,EAAM,GAGvBb,eAAgB,SAASvY,GACrB,OAAO2R,KAAKwH,MAAMnZ,EAAI2R,KAAK2G,mBAG/BtB,WAAY,SAAS0B,EAAM/B,GACvB,MAAO,CACH+B,EAAK,GAAM/B,EAAchF,KAAK0G,UAC9BK,EAAK,GAAM/B,EAAchF,KAAK0G,UAC9BK,EAAK,GAAM/B,EAAchF,KAAK0G,UAC9BK,EAAK,GAAM/B,EAAchF,KAAK0G,aAS1C7H,EAAOC,QAJP,SAAcpL,EAAQ8Q,GAClB,OAAO,IAAIgC,EAAK9S,EAAQ8Q,K,iBClF5B3F,EAAOC,QAAU,CAEb+E,KAAM,SAASpB,EAAUa,GACrB,YAAe1W,IAAX0W,EACOb,EAAS3N,QAEb2N,EAASlU,KAAI,SAAS+V,GAGzB,OADe,IAAIoD,SAAS,KAAM,aAAepE,EAAO,GAAtB,MAAwCA,EAAO,GAAK,KAC/EqE,CAAOrD,OAItBqB,OAAQ,SAASlD,EAAUa,GACvB,YAAe1W,IAAX0W,EACOb,EAAS3N,QAEb2N,EAASlU,KAAI,SAAS+V,GAGzB,OADgB,IAAIoD,SAAS,KAAM,kBAAoBpE,EAAO,GAAK,aAAeA,EAAO,GAAK,qBACvFsE,CAAQtD,S,iBCpB3B,SAASuD,EAAOzP,EAAG0J,EAAGC,GAClB,OAAQD,EAAE,GAAK1J,EAAE,KAAO2J,EAAE,GAAK3J,EAAE,KAAO0J,EAAE,GAAK1J,EAAE,KAAO2J,EAAE,GAAK3J,EAAE,IAqCrEyG,EAAOC,QARP,SAAgB2D,GACZ,IAAMqF,EA3BV,SAAuBrF,GAEnB,IADA,IAAMsF,EAAQ,GACLC,EAAI,EAAGA,EAAIvF,EAASvX,OAAQ8c,IAAK,CACtC,KAAOD,EAAM7c,QAAU,GAAM2c,EAAOE,EAAMA,EAAM7c,OAAS,GAAI6c,EAAMA,EAAM7c,OAAS,GAAIuX,EAASuF,KAAO,GAClGD,EAAME,MAEVF,EAAMzc,KAAKmX,EAASuF,IAGxB,OADAD,EAAME,MACCF,EAkBOG,CAAczF,GAEtBrP,EAjBV,SAAuBqP,GAGnB,IAFA,IAAM0F,EAAW1F,EAASlO,UACtBuT,EAAQ,GACHM,EAAI,EAAGA,EAAID,EAASjd,OAAQkd,IAAK,CACtC,KAAON,EAAM5c,QAAU,GAAM2c,EAAOC,EAAMA,EAAM5c,OAAS,GAAI4c,EAAMA,EAAM5c,OAAS,GAAIid,EAASC,KAAO,GAClGN,EAAMG,MAEVH,EAAMxc,KAAK6c,EAASC,IAGxB,OADAN,EAAMG,MACCH,EAMOO,CAAc5F,GACPqB,OAAOgE,GAE5B,OADA1U,EAAO9H,KAAKmX,EAAS,IACdrP","file":"static/js/9.37915e03.chunk.js","sourcesContent":["import React, {useEffect, useRef, useState} from 'react';\nimport * as d3 from 'd3';\nimport raw from 'raw.macro';\nimport Table from './PercentTable';\nimport styled from 'styled-components';\nimport {interval} from 'd3-timer';\nimport * as polished from 'polished';\nimport hull from 'hull.js';\n\nconst Tooltip = styled.div`\n  position: fixed;\n  max-width: 100px;\n  font-family: 'OfficeCodeProWeb', monospace;\n  font-size: 0.75rem;\n  text-align: center;\n  pointer-events: none;\n  transform: translate(-50%, calc(-100% - 1rem));\n  font-weight: 600;\n  color: black;\n  text-shadow:\n   -1px -1px 0 #fff,  \n    1px -1px 0 #fff,\n    -1px 1px 0 #fff,\n     1px 1px 0 #fff;\n`;\n\nfunction getLines(ctx, text, maxWidth) {\n    var words = text.split(\" \");\n    var lines = [];\n    var currentLine = words[0];\n\n    for (var i = 1; i < words.length; i++) {\n        var word = words[i];\n        var width = ctx.measureText(currentLine + \" \" + word).width;\n        if (width < maxWidth) {\n            currentLine += \" \" + word;\n        } else {\n            lines.push(currentLine);\n            currentLine = word;\n        }\n    }\n    lines.push(currentLine);\n    return lines;\n}\n\nconst minExpectedScreenSize = 1020;\n\n// const data = JSON.parse(raw('../data/industry-space-with-start-positions.json'));\nconst data = JSON.parse(raw('../data/umap-clusters-custom-2.json'));\nconst proximityNodes = JSON.parse(raw('../data/proximity-min-max.json'));\nconst naicsData = JSON.parse(raw('../data/naics_2017.json'));\nconst clusterMap = JSON.parse(raw('../data/clusters-mapping-1.json'));\n\n// const allC2 = [];\n// clusterMap.forEach(({C2}) => allC2.includes(C2) ? null : allC2.push(C2));\n// console.log(allC2)\n\nconst allProximities = [];\nfor (let node in proximityNodes) {\n  proximityNodes[node].forEach(({proximity}) => allProximities.push(proximity));\n}\nconst proximityRange = d3.extent(allProximities);\nconst proximityScale = d3.scaleLinear()\n    .domain(proximityRange)\n    .range([0, 100]);\n\nconst colorMap = [\n  { id: '0', color: '#A973BE' },\n  { id: '1', color: '#F1866C' },\n  { id: '2', color: '#FFC135' },\n  { id: '3', color: '#93CFD0' },\n  { id: '4', color: '#488098' },\n  { id: '5', color: '#77C898' },\n  { id: '6', color: '#6A6AAD' },\n  { id: '7', color: '#D35162' },\n  { id: '8', color: '#F28188' },\n]\n\nconst createForceGraph = (rootEl, data, setNodeList, setHovered) => {\n  const root = d3.select(rootEl);\n\n  const height = window.innerHeight;\n  const width =  window.innerWidth - 450;\n\n  const smallerSize = width < height ? width : height;\n  const padding = smallerSize * 0.1;\n  const widthMargin = (width - smallerSize) / 2;\n  const heightMargin = (height - (smallerSize * 0.9)) / 2;\n  const rangeWidth = width - padding - widthMargin;\n  const rangeHeight = height - padding - heightMargin;\n\n  const allXValues = [];\n  const allYValues = [];\n  data.nodes.forEach(({x, y}) => {\n    allXValues.push(x);\n    allYValues.push(y);\n  });\n\n  // const radiusAdjuster = smallerSize / minExpectedScreenSize;\n\n  data.nodes = data.nodes.map(n => {\n    // let radius = Math.random() * 6;\n    // radius = radius < 2.5 ? 2.5 * radiusAdjuster : radius * radiusAdjuster;\n    const radius = 2.5;\n    const industry6Digit = naicsData.find(({code}) => n.id.toString() === code);\n    if (!industry6Digit) {\n      throw new Error('undefined industry');\n      \n    }\n    const naics_id = industry6Digit.naics_id;\n    const label = industry6Digit.name;\n    let topLevelParentId = naics_id.toString();\n    let current = naicsData.find(datum => datum.naics_id === naics_id);\n    while(current && current.parent_id !== null) {\n    // eslint-disable-next-line\n      current = naicsData.find(datum => datum.naics_id === current.parent_id);\n      if (current && current.parent_id !== null) {\n        topLevelParentId = current.parent_id.toString();\n      } else if (current && current.naics_id !== null) {\n        topLevelParentId = current.naics_id.toString();\n      }\n    }\n    if (parseInt(topLevelParentId, 10) > 8) {\n      console.error(current);\n      throw new Error('Parent out of range')\n    }\n    \n    const {color} = colorMap.find(({id}) => id === topLevelParentId);\n\n    return {\n      ...n,\n      radius,\n      color,\n      parent: current,\n      label,\n      initial_x: n.x,\n      initial_y: n.y,\n    }\n  })\n\n\n  const xRange = d3.extent(allXValues);\n  const yRange = d3.extent(allYValues);\n\n  const xScale = d3.scaleLinear()\n    .domain(xRange)\n    .range([0 + padding + widthMargin, rangeWidth]);\n\n  const yScale = d3.scaleLinear()\n    .domain(yRange)\n    .range([ rangeHeight, 0 + padding + heightMargin]);\n\n  const canvas = root.append('canvas')\n    .attr('width', width + 'px')\n    .attr('height', height + 'px')\n    .node();\n\n  const context = canvas.getContext('2d');\n\n\n  const simulation = d3.forceSimulation()\n                .force(\"center\", d3.forceCenter(rangeWidth / 1.3, rangeHeight / 1.8))\n                .force(\"charge\", d3.forceManyBody().strength(-10))\n                .force(\"collision\", d3.forceCollide().radius(function(d) {\n                  return (d.radius * 1.25) * (minExpectedScreenSize / smallerSize);\n                }))\n                .force(\"link\", d3.forceLink().strength(d => d.proximity).id(d => d.id))\n                .alphaDecay(0.99)\n\n  let transform = d3.zoomIdentity;\n\n\n  let hoveredNode = undefined;\n  let highlightedNode = undefined;\n  let primaryNodes = [];\n  let secondaryNodes = [];\n  let shouldTick = false;\n\n  const update = initGraph(data);\n\n  function initGraph(tempData){\n\n    function zoomed() {\n      transform = d3.event.transform;\n      simulationUpdate();\n    }\n\n    const zoom = d3.zoom().scaleExtent([1 / 10, 8]).on(\"zoom\", zoomed);\n\n    function drawPoint(r, currentPoint, totalPoints, centerX, centerY) {  \n\n      var theta = ((Math.PI*2) / totalPoints);\n      var angle = (theta * currentPoint);\n\n      const x = (r * Math.cos(angle) + centerX);\n      const y = (r * Math.sin(angle) + centerY);\n\n      return {x, y};\n    }\n\n    const canvasEl = d3.select(canvas);\n    canvasEl\n      .call(zoom)\n      .on('mousemove', function() {\n        if (!shouldTick) {\n          hoveredNode = dragsubject();\n          setHovered({node: hoveredNode, coords: {x: d3.event.x, y: d3.event.y}});\n          simulationUpdate();\n        }\n      })\n      .on('click', function(event) {\n        const node = dragsubject();\n        if (node) {\n          highlightedNode = node;\n          primaryNodes = [];\n          secondaryNodes = [];\n          proximityNodes[node.id].forEach(({trg, proximity}, i) => {\n            const node2 = tempData.nodes.find(n => n.id === trg);\n            if (node2) {\n              const numPrimary = Math.floor((proximityNodes[node.id].length - 1) / 2);\n              const numSecondary = proximityNodes[node.id].length - numPrimary;\n              if (i < numPrimary) {\n                const newCoords = drawPoint(20, i, numPrimary, node.x, node.y)\n                node2.new_x = newCoords.x;\n                node2.new_y = newCoords.y;\n                const xDist = newCoords.x > node2.x ? newCoords.x - node2.x : node2.x - newCoords.x;\n                const yDist = newCoords.y > node2.y ? newCoords.y - node2.y : node2.y - newCoords.y;\n                node2.x_interval = xDist / 20;\n                node2.y_interval = yDist / 20;\n                primaryNodes.push({\n                  ...node2,\n                  proximity,\n                });\n              } else {\n                const newCoords = drawPoint(40, i, numSecondary, node.x, node.y)\n                node2.new_x = newCoords.x;\n                node2.new_y = newCoords.y;\n                const xDist = newCoords.x > node2.x ? newCoords.x - node2.x : node2.x - newCoords.x;\n                const yDist = newCoords.y > node2.y ? newCoords.y - node2.y : node2.y - newCoords.y;\n                node2.x_interval = xDist / 20;\n                node2.y_interval = yDist / 20;\n                secondaryNodes.push({\n                  ...node2,\n                  proximity,\n                });\n              }\n            }\n          });\n          const allEdgeXValues = [];\n          const allEdgeYValues = [];\n          [...primaryNodes, ...secondaryNodes].forEach(n => {\n            allEdgeXValues.push(xScale(n.new_x));\n            allEdgeYValues.push(yScale(n.new_y));\n          });\n\n          const xBounds = d3.extent(allEdgeXValues);\n          const yBounds = d3.extent(allEdgeYValues);\n          const bounds = [\n            [xBounds[0], yBounds[0]],\n            [xBounds[1], yBounds[1]],\n          ];\n          const dx = bounds[1][0] - bounds[0][0];\n          const dy = bounds[1][1] - bounds[0][1];\n          const x = (bounds[0][0] + bounds[1][0]) / 2;\n          const y = (bounds[0][1] + bounds[1][1]) / 2;\n          const scale = Math.max(1, Math.min(8, 0.9 / Math.max(dx / rangeWidth, dy / rangeHeight)));\n          const translate = [width / 2 - scale * x, height / 2 - scale * y];\n\n          canvasEl.transition()\n              .duration(500)\n              .call( zoom.transform, d3.zoomIdentity.translate(translate[0],translate[1]).scale(scale))\n\n          const t = interval(function(elapsed) {\n            shouldTick = false;\n            [...primaryNodes, ...secondaryNodes].forEach(n => {\n              const currentNode = tempData.nodes.find(d => d.id === n.id);\n              if (Math.ceil(currentNode.x) === Math.ceil(currentNode.new_x)) {\n                currentNode.x = currentNode.new_x;\n              } else {\n                shouldTick = true;\n                currentNode.x = currentNode.x > currentNode.new_x\n                  ? currentNode.x - currentNode.x_interval\n                  : currentNode.x + currentNode.x_interval;\n              }\n              if (Math.ceil(currentNode.y) === Math.ceil(currentNode.new_y)) {\n                currentNode.y = currentNode.new_y;\n              } else {\n                shouldTick = true;\n                currentNode.y = currentNode.y > currentNode.new_y\n                  ? currentNode.y - currentNode.y_interval\n                  : currentNode.y + currentNode.y_interval;\n              }\n            });\n            simulationUpdate();\n            if (!shouldTick || elapsed > 350) {\n              t.stop()\n            };\n          }, 10);\n          setNodeList({\n            selected: node,\n            connected: [...primaryNodes, ...secondaryNodes],\n          })\n          setHovered({node: undefined, coords: {x: d3.event.x, y: d3.event.y}});\n        }\n        simulationUpdate();\n      })\n\n\n\n    function dragsubject() {\n      const x = transform.invertX(d3.event.x);\n      const y = transform.invertY(d3.event.y);\n      for (let i = tempData.nodes.length - 1; i >= 0; --i) {\n        const node = tempData.nodes[i];\n        let nodeX = xScale(node.x);\n        let nodeY = yScale(node.y);\n        const dx = x - nodeX;\n        const dy = y - nodeY;\n\n        if (dx * dx + dy * dy < node.radius * node.radius) {\n\n          nodeX =  transform.applyX(nodeX);\n          nodeY = transform.applyY(nodeY);\n\n          if ((!primaryNodes.length && !secondaryNodes.length) ||\n                primaryNodes.find(n => n.id === node.id) ||\n                secondaryNodes.find(n => n.id === node.id)) {\n\n            return node;\n          }\n\n        }\n      }\n    }\n\n    simulation.nodes(tempData.nodes)\n              .on(\"tick\", simulationUpdate);\n\n    simulation.force(\"link\")\n              .links(tempData.edges);\n\n    function simulationUpdate() {\n      const highlightedId = highlightedNode && highlightedNode.id ? highlightedNode.id : undefined;\n\n      context.save();\n\n      context.clearRect(0, 0, width, height);\n      context.translate(transform.x, transform.y);\n      context.scale(transform.k, transform.k);\n\n      // Draw the cluster shapes \n      if (highlightedId === undefined) {\n        const convexMap = [\n          { id: '0', color: '#93CFD0', coords: [] },\n          { id: '15', color: '#488098', coords: [] },\n          { id: '8', color: '#77C898', coords: [] },\n          { id: '3', color: '#A973BE', coords: [] },\n          { id: '5', color: '#F1866C', coords: [] },\n          { id: '32', color: '#D35162', coords: [] },\n          { id: '14', color: '#FFC135', coords: [] },\n          { id: '24', color: '#93CFD0', coords: [] },\n          { id: '36', color: '#488098', coords: [] },\n          { id: '13', color: '#77C898', coords: [] },\n          { id: '26', color: '#A973BE', coords: [] },\n          { id: '6', color: '#F1866C', coords: [] },\n          { id: '19', color: '#D35162', coords: [] },\n          { id: '29', color: '#FFC135', coords: [] },\n          { id: '20', color: '#93CFD0', coords: [] },\n          { id: '10', color: '#488098', coords: [] },\n          { id: '7', color: '#77C898', coords: [] },\n          { id: '17', color: '#A973BE', coords: [] },\n          { id: '12', color: '#F1866C', coords: [] },\n          { id: '18', color: '#D35162', coords: [] },\n          { id: '35', color: '#FFC135', coords: [] },\n          { id: '21', color: '#93CFD0', coords: [] },\n          { id: '37', color: '#488098', coords: [] },\n          { id: '30', color: '#77C898', coords: [] },\n          { id: '22', color: '#A973BE', coords: [] },\n          { id: '23', color: '#F1866C', coords: [] },\n          { id: '40', color: '#D35162', coords: [] },\n          { id: '27', color: '#FFC135', coords: [] },\n          { id: '28', color: '#93CFD0', coords: [] },\n          { id: '38', color: '#488098', coords: [] },\n          { id: '33', color: '#77C898', coords: [] },\n          { id: '39', color: '#A973BE', coords: [] },\n        ]\n\n        clusterMap.forEach(({naics, C2}) => {\n          const node = tempData.nodes.find(({id}) => id.toString() === naics.toString());\n          const convex = convexMap.find(({id}) => id.toString() === C2.toString());\n          if (node && convex) {\n            convex.coords.push([node.x, node.y]);\n          }\n        })\n\n        // const cornerRadius = 30;\n        context.lineWidth = 2;\n        convexMap.forEach(({coords, color}) => {\n          context.fillStyle = polished.rgba(color, 0.095);\n          context.strokeStyle = polished.rgba(color, 0.5);\n          context.beginPath(); // start a new path\n\n          // const points = hull(coords.map(([x, y]) => [xScale(x), yScale(y)]), 60)\n          //                 .map(([x, y]) => ({x, y}));\n          // roundedPoly(context, points, cornerRadius);\n          // context.fill();\n          // context.stroke();\n\n          const points = hull(coords.map(([x, y]) => [xScale(x), yScale(y)]), 200)\n          context.beginPath();\n          context.lineCap = 'round'\n          points.forEach((point, i) => {\n            if (i === 0) {\n              context.moveTo(...point);\n            } else {\n              context.lineTo(...point);\n            }\n          })\n          context.closePath();\n          context.stroke();\n          context.fill();\n        })\n        context.lineWidth = 1;\n      } \n\n\n      // Draw the nodes\n      if (highlightedNode) {\n        context.beginPath();\n        context.arc(\n          xScale(highlightedNode.x),\n          yScale(highlightedNode.y),\n          20 / (minExpectedScreenSize / smallerSize),\n          0,\n          2 * Math.PI,\n          true\n        );\n        context.strokeStyle = '#dfdfdf';\n        context.lineWidth = 0.2;\n        context.stroke();\n\n        context.beginPath();\n        context.arc(\n          xScale(highlightedNode.x),\n          yScale(highlightedNode.y),\n          40 / (minExpectedScreenSize / smallerSize),\n          0,\n          2 * Math.PI,\n          true\n        );\n        context.stroke();\n\n        context.beginPath();\n        context.arc(xScale(highlightedNode.x), yScale(highlightedNode.y), highlightedNode.radius, 0, 2 * Math.PI, true);\n        context.fillStyle = highlightedNode.color\n        context.fill();\n        context.strokeStyle = 'black';\n        context.stroke();\n\n\n        context.textAlign = 'center';\n        context.textBaseline = 'middle';\n        context.fillStyle = \"#000\";\n        context.font = `400 1.3px OfficeCodeProWeb`;\n        getLines(context, highlightedNode.label, 15).reverse().forEach((t, i) => {\n          context.fillText(t, xScale(highlightedNode.x), yScale(highlightedNode.y) - (2 * (i + 2)));\n        });\n      }\n      let nodeCount = 1;\n      if (!primaryNodes.length && !secondaryNodes.length) {\n        tempData.nodes.forEach(function(d, i) {\n          context.beginPath();\n          context.arc(xScale(d.x), yScale(d.y), d.radius, 0, 2 * Math.PI, true);\n          context.fillStyle = !hoveredNode ||\n            (hoveredNode.id === d.id || proximityNodes[hoveredNode.id].find(n => n.trg === d.id))\n            ? d.color : polished.rgba(d.color, 0.125);\n          context.fill();\n        });\n\n\n        if (hoveredNode) {\n          const linkedNodes = [hoveredNode];\n          proximityNodes[hoveredNode.id].forEach(function({trg}) {\n            const targetNode = tempData.nodes.find(({id}) => id === trg);\n            context.beginPath();\n            context.moveTo(xScale(hoveredNode.x), yScale(hoveredNode.y));\n            context.lineTo(xScale(targetNode.x), yScale(targetNode.y));\n            context.strokeStyle = '#afafaf';\n            context.stroke();\n            linkedNodes.push(targetNode);\n          });\n\n          linkedNodes.forEach(function(d, i) {\n            if (d) {\n              context.beginPath();\n              context.arc(xScale(d.x), yScale(d.y), d.radius, 0, 2 * Math.PI, true);\n              context.fillStyle = d.color;\n              context.fill();\n              context.strokeStyle = '#afafaf';\n              context.stroke();\n            }\n          });\n        }\n      } else {\n        [...primaryNodes, ...secondaryNodes].forEach(function(d, i) {\n          const node = tempData.nodes.find(n => n.id === d.id);\n          context.beginPath();\n          context.arc(xScale(node.x), yScale(node.y), node.radius, 0, 2 * Math.PI, true);\n          context.fillStyle = node.color;\n          context.fill();\n\n          context.textAlign = 'center';\n          context.textBaseline = 'middle';\n          context.font = `400 ${node.radius}px OfficeCodeProWeb`;\n          context.fillStyle = \"white\";\n          context.fillText(String.fromCharCode(64 + nodeCount++), xScale(node.x), yScale(node.y));\n\n\n          if (!hoveredNode || hoveredNode.id !== d.id) {\n            context.fillStyle = \"#000\";\n            context.font = `400 1.3px OfficeCodeProWeb`;\n            const shortenedLabel = d.label.length <= 30 ? d.label : d.label.slice(0, 30) + '...'\n            getLines(context, shortenedLabel, 15).reverse().forEach((t, i) => {\n              context.fillText(t, xScale(node.x), yScale(node.y) - (2 * (i + 2)));\n            });\n          }\n        });\n      }\n\n      if (hoveredNode && hoveredNode.id !== highlightedId) {\n        rootEl.style.cursor = 'pointer';\n        context.beginPath();\n        context.arc(xScale(hoveredNode.x), yScale(hoveredNode.y), hoveredNode.radius, 0, 2 * Math.PI, true);\n        context.strokeStyle = 'black';\n        context.stroke();\n      } else {\n        rootEl.style.cursor = 'move';\n      }\n\n      context.restore();\n    }\n\n    const triggerSimulationUpdate = (node) => {\n      if (node) {\n        highlightedNode = node;\n        primaryNodes = [];\n        secondaryNodes = [];\n        proximityNodes[node.id].forEach(({trg, proximity}, i) => {\n          const node2 = tempData.nodes.find(n => n.id === trg);\n          if (node2) {\n            const numPrimary = Math.floor((proximityNodes[node.id].length - 1) / 2);\n            const numSecondary = proximityNodes[node.id].length - numPrimary;\n            if (i < numPrimary) {\n              const newCoords = drawPoint(20, i, numPrimary, node.x, node.y)\n              node2.new_x = newCoords.x;\n              node2.new_y = newCoords.y;\n              const xDist = newCoords.x > node2.x ? newCoords.x - node2.x : node2.x - newCoords.x;\n              const yDist = newCoords.y > node2.y ? newCoords.y - node2.y : node2.y - newCoords.y;\n              node2.x_interval = xDist / 20;\n              node2.y_interval = yDist / 20;\n              primaryNodes.push({\n                ...node2,\n                proximity,\n              });\n            } else {\n              const newCoords = drawPoint(40, i, numSecondary, node.x, node.y)\n              node2.new_x = newCoords.x;\n              node2.new_y = newCoords.y;\n              const xDist = newCoords.x > node2.x ? newCoords.x - node2.x : node2.x - newCoords.x;\n              const yDist = newCoords.y > node2.y ? newCoords.y - node2.y : node2.y - newCoords.y;\n              node2.x_interval = xDist / 20;\n              node2.y_interval = yDist / 20;\n              secondaryNodes.push({\n                ...node2,\n                proximity,\n              });\n            }\n          }\n        });\n        const allEdgeXValues = [];\n        const allEdgeYValues = [];\n        [...primaryNodes, ...secondaryNodes].forEach(n => {\n          allEdgeXValues.push(xScale(n.new_x));\n          allEdgeYValues.push(yScale(n.new_y));\n        });\n\n        const xBounds = d3.extent(allEdgeXValues);\n        const yBounds = d3.extent(allEdgeYValues);\n        const bounds = [\n          [xBounds[0], yBounds[0]],\n          [xBounds[1], yBounds[1]],\n        ];\n        const dx = bounds[1][0] - bounds[0][0];\n        const dy = bounds[1][1] - bounds[0][1];\n        const x = (bounds[0][0] + bounds[1][0]) / 2;\n        const y = (bounds[0][1] + bounds[1][1]) / 2;\n        const scale = Math.max(1, Math.min(8, 0.9 / Math.max(dx / rangeWidth, dy / rangeHeight)));\n        const translate = [width / 2 - scale * x, height / 2 - scale * y];\n\n        canvasEl.transition()\n            .duration(500)\n            .call( zoom.transform, d3.zoomIdentity.translate(translate[0],translate[1]).scale(scale));\n\n        const t = interval(function(elapsed) {\n          shouldTick = false;\n          [...primaryNodes, ...secondaryNodes].forEach(n => {\n            const currentNode = tempData.nodes.find(d => d.id === n.id);\n            if (Math.ceil(currentNode.x) === Math.ceil(currentNode.new_x)) {\n              currentNode.x = currentNode.new_x;\n            } else {\n              shouldTick = true;\n              currentNode.x = currentNode.x > currentNode.new_x\n                ? currentNode.x - currentNode.x_interval\n                : currentNode.x + currentNode.x_interval;\n            }\n            if (Math.ceil(currentNode.y) === Math.ceil(currentNode.new_y)) {\n              currentNode.y = currentNode.new_y;\n            } else {\n              shouldTick = true;\n              currentNode.y = currentNode.y > currentNode.new_y\n                ? currentNode.y - currentNode.y_interval\n                : currentNode.y + currentNode.y_interval;\n            }\n          });\n          simulationUpdate();\n          if (!shouldTick || elapsed > 350) {\n            t.stop()\n          };\n        }, 10);\n        setNodeList({\n          selected: node,\n          connected: [...primaryNodes, ...secondaryNodes],\n        })\n      } else {\n        setNodeList(undefined);\n      }\n      simulationUpdate();\n    }\n    const clearSelections = () => {\n      const allEdgeXValues = [];\n      const allEdgeYValues = [];\n      tempData.nodes.forEach(n => {\n        allEdgeXValues.push(xScale(n.x));\n        allEdgeYValues.push(yScale(n.y));\n        n.x = n.initial_x;\n        n.y = n.initial_y;\n      });\n\n      const xBounds = d3.extent(allEdgeXValues);\n      const yBounds = d3.extent(allEdgeYValues);\n      const bounds = [\n        [xBounds[0], yBounds[0]],\n        [xBounds[1], yBounds[1]],\n      ];\n      const dx = bounds[1][0] - bounds[0][0];\n      const dy = bounds[1][1] - bounds[0][1];\n      const x = (bounds[0][0] + bounds[1][0]) / 2;\n      const y = (bounds[0][1] + bounds[1][1]) / 2;\n      const scale = Math.max(1, Math.min(8, 0.9 / Math.max(dx / rangeWidth, dy / rangeHeight)));\n      const translate = [width / 2 - scale * x, height / 2 - scale * y];\n\n      canvasEl.transition()\n          .duration(500)\n          .call( zoom.transform, d3.zoomIdentity.translate(translate[0],translate[1]).scale(scale));\n      hoveredNode = undefined;\n      highlightedNode = undefined;\n      primaryNodes = [];\n      secondaryNodes = [];\n      setNodeList(undefined);\n      simulationUpdate();\n    }\n    return {triggerSimulationUpdate, clearSelections};\n  }\n  setTimeout(() => {\n    update.clearSelections();\n  }, 0)\n\n  return update;\n}\n\nexport default () => {\n  const rootNodeRef = useRef(null);\n  const [nodeList, setNodeList] = useState(undefined);\n  const [hovered, setHovered] = useState(undefined);\n  const [updateSimulation, setUpdateSimulation] = useState(undefined);\n\n  useEffect(() => {\n    let rootEl = null;\n    if (rootNodeRef && rootNodeRef.current) {\n      rootEl = rootNodeRef.current;\n      const triggerSimulationUpdate = createForceGraph(rootEl, data, setNodeList, setHovered);\n      setUpdateSimulation(triggerSimulationUpdate);\n    }\n    return (() => {\n      if (rootEl) {\n        rootEl.innerHTML = '';\n      }\n    })\n  }, [rootNodeRef, setNodeList, setHovered, setUpdateSimulation]);\n\n  const tooltip = hovered && hovered.node ? (\n    <Tooltip\n      style={{top: hovered.coords.y, left: hovered.coords.x}}\n    >\n      {hovered.node.label.replace(hovered.node.id, '')}\n    </Tooltip>\n  ) : null\n\n  return (\n    <div>\n      {tooltip}\n      <div ref={rootNodeRef} />\n      <Table\n        nodes={nodeList}\n        hovered={hovered}\n        updateSimulation={updateSimulation}\n        proximityScale={proximityScale}\n      />\n    </div>\n  );\n}\n","import React from 'react'\nimport CanvasIndustrySpace from '../components/CanvasIndustrySpaceUMapClustersRingsClusterConvexLv2';\n\nexport default () => {\n  return (\n    <div>\n      <CanvasIndustrySpace />\n    </div>\n  );\n}\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(n);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import React, {useRef, useEffect, useState} from 'react';\nimport styled from 'styled-components';\nimport {rgba} from 'polished';\nimport PNGLegend1 from '../IS-Legends-01.png';\nimport PNGLegend2 from '../IS-Legends-02.png';\nimport HowToReadPNG from '../IS_how-to-read-04.png';\n\nconst Root = styled.div`\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  width: 450px;\n  padding: 1rem;\n  font-family: 'OfficeCodeProWeb', monospace;\n`;\n\nconst BackButton = styled.button`\n  position: fixed;\n  left: 0;\n  top: 0;\n  background-color: transparent;\n  border: none;\n  font-size: 1rem;\n  font-family: 'OfficeCodeProWeb', monospace;\n  cursor: pointer;\n  padding: 1rem;\n`;\n\nconst HowToReadButton = styled.button`\n  position: fixed;\n  left: 1rem;\n  top: 4rem;\n  background-color: transparent;\n  border: solid 1px #333;\n  font-size: 1rem;\n  font-family: 'OfficeCodeProWeb', monospace;\n  cursor: pointer;\n  padding: 0.5rem;\n`;\n\nconst Content = styled.div`\n  padding: 1rem;\n  box-sizing: border-box;\n  box-shadow: 1px 2px 5px 0px rgba(0,0,0,0.45);\n  display: grid;\n  grid-template-rows: auto 1fr auto;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(255, 255, 255, 0.55);\n`;\n\nconst NodeList = styled.div`\n  margin-top: 1rem;\n  overflow: auto;\n  position: relative;\n`;\n\nconst NodeListItem = styled.div`\n  display: grid;\n  grid-template-columns: 180px 1fr 1fr;\n  font-size: 0.8rem;\n\n  &:hover {\n    ${({$color}) => $color ? 'background-color:' + rgba($color, 0.4) + ';' : ''}\n    cursor: pointer;\n  }\n`;\n\nconst TableTitle = styled(NodeListItem)`\n  border-bottom: solid 1px black;\n  position: sticky;\n  top: 0;\n  background-color: #fff;\n`;\n\nconst Cell = styled.div`\n  padding: 0.5rem;\n  display: flex;\n  align-items: center;\n`;\nconst Rank = styled.strong`\n  margin-right: 0.7rem;\n`;\n\nconst SectorCell = styled(Cell)`\n  border-left: solid 1px #000;\n`;\nconst ProximityCell = styled(Cell)`\n  justify-content: flex-end;\n`;\n\nconst Title = styled.h1`\n  font-size: 1rem;\n  font-weight: 400;\n  margin: 0;\n  display: flex;\n  align-items: center;\n`;\n\nconst Empty = styled(Title)`\n  height: 100%;\n  width: 100%;\n  text-align: center;\n  grid-row: 1 / -1;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Circle = styled.div`\n  border: solid 3px black;\n  border-radius: 400px;\n  width: 0.75rem;\n  height: 0.7rem;\n  margin-right: 0.5rem;\n  flex-shrink: 0;\n`;\n\nconst Label = styled.span`\n  text-transform: uppercase;\n`;\n\nconst EmptyImage = styled.div`\n  width: 100%;\n  height: 100%;\n  grid-row: 3;\n  grid-column: 1 / -1;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  margin: 2rem 0;\n\n  img {\n    max-width: 100%;\n    margin: auto;\n  }\n`;\n\nconst ModalContainer = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 2000;\n  padding: 1rem;\n  box-sizing: border-box;\n`;\n\nconst ModalBackdrop = styled.button`\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border: none;\n  background-color: rgba(0, 0, 0, 0.5);\n`;\n\nconst ModalContent = styled.div`\n  width: 100%;\n  max-width: 1200px;\n  padding: 1rem;\n  position: relative;\n  background-color: #fff;\n\n  img {\n    max-width: 100%;\n  }\n`;\n\n\nconst CloseButton = styled.button`\n  border: none;\n  padding: 0.8rem;\n  background-color: transparent;\n  color: #999;\n  position: absolute;\n  top: 0;\n  right: 0;\n  cursor: pointer;\n  font-size: 1.2rem\n`;\n\nconst Table = (props) => {\n  const {nodes, hovered, updateSimulation, proximityScale, showToggle} = props;\n  const highlightedRef = useRef(null);\n  const containerRef = useRef(null);\n  const [modalOpen, setModalOpen] = useState(false);\n\n  const modal = modalOpen ? (\n    <ModalContainer>\n      <ModalBackdrop onClick={() => setModalOpen(false)} />\n      <ModalContent>\n        <img src={HowToReadPNG} alt={''} />\n        <CloseButton onClick={() => setModalOpen(false)}>\n          ×\n        </CloseButton>\n      </ModalContent>\n    </ModalContainer>\n  ) : null;\n\n  useEffect(() => {\n    if (highlightedRef && highlightedRef.current && containerRef && containerRef.current && hovered !== undefined) {\n      const highlightedNode = highlightedRef.current;\n      const containerNode = containerRef.current;\n      containerNode.scrollTop = highlightedNode.offsetTop - highlightedNode.offsetHeight;\n    }\n  }, [highlightedRef, containerRef, hovered])\n\n  const imgSrc = showToggle ? PNGLegend2 : PNGLegend1;\n  if (nodes) {\n    const {selected, connected} = nodes;\n    const title = selected.label.replace(selected.id, '');\n    const connectedNodes = connected.map((node, i) => {\n      const {id, label, color, parent, proximity} = node;\n      const highlight = hovered && hovered.node && hovered.node.id === id;\n      const onClick = () => updateSimulation ? updateSimulation.triggerSimulationUpdate(node) : null;\n      const strength = parseFloat(proximityScale(proximity).toFixed(2));\n      return (\n        <NodeListItem\n          $color={color}\n          style={{backgroundColor: highlight ? rgba(color, 0.4) : undefined}}\n          ref={highlight ? highlightedRef : undefined}\n          onClick={onClick}\n          key={id}\n        >\n          <Cell\n            style={{borderLeft: `5px solid ${color}`}}\n          >\n            <Rank>{String.fromCharCode(64 + (i + 1))}</Rank>\n            <div>{label.replace(id, '')}</div>\n          </Cell>\n          <SectorCell>{parent.name}</SectorCell>\n          <ProximityCell>{strength}%</ProximityCell>\n        </NodeListItem>\n      );\n    })\n    const onClear = () => updateSimulation ? updateSimulation.clearSelections() : null;\n    return (\n      <Root>\n        <BackButton onClick={onClear}>{'< Back to Industry Space'}</BackButton>\n        <HowToReadButton onClick={() => setModalOpen(true)}>How to Read</HowToReadButton>\n        <Content>\n          <Title>\n            <Circle style={{backgroundColor: selected.color}} />\n            <div><Label>Selected industry:</Label> {title}</div>\n          </Title>\n          <NodeList ref={containerRef}>\n            <TableTitle>\n              <Cell>Industry Name</Cell>\n              <SectorCell style={{border: 'none'}}>Sector</SectorCell>\n              <ProximityCell>Relatedness</ProximityCell>\n            </TableTitle>\n            {connectedNodes}\n          </NodeList>\n        </Content>\n        {modal}\n      </Root>\n    );\n  } else {\n    return (\n      <Root>\n        <HowToReadButton onClick={() => setModalOpen(true)}>How to Read</HowToReadButton>\n        <Content>\n          <Empty>\n            <EmptyImage><img src={imgSrc} alt={''} /></EmptyImage>\n          </Empty>\n        </Content>\n        {modal}\n      </Root>\n    );\n  }\n}\n\nexport default Table;\n","module.exports = __webpack_public_path__ + \"static/media/IS-Legends-01.c6d7ff3f.png\";","module.exports = __webpack_public_path__ + \"static/media/IS-Legends-02.c6d7ff3f.png\";","module.exports = __webpack_public_path__ + \"static/media/IS_how-to-read-04.aaacab25.png\";","var frame = 0, // is an animation frame pending?\n    timeout = 0, // is a timeout pending?\n    interval = 0, // are any timers active?\n    pokeDelay = 1000, // how frequently we check for clock skew\n    taskHead,\n    taskTail,\n    clockLast = 0,\n    clockNow = 0,\n    clockSkew = 0,\n    clock = typeof performance === \"object\" && performance.now ? performance : Date,\n    setFrame = typeof window === \"object\" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(f) { setTimeout(f, 17); };\n\nexport function now() {\n  return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);\n}\n\nfunction clearNow() {\n  clockNow = 0;\n}\n\nexport function Timer() {\n  this._call =\n  this._time =\n  this._next = null;\n}\n\nTimer.prototype = timer.prototype = {\n  constructor: Timer,\n  restart: function(callback, delay, time) {\n    if (typeof callback !== \"function\") throw new TypeError(\"callback is not a function\");\n    time = (time == null ? now() : +time) + (delay == null ? 0 : +delay);\n    if (!this._next && taskTail !== this) {\n      if (taskTail) taskTail._next = this;\n      else taskHead = this;\n      taskTail = this;\n    }\n    this._call = callback;\n    this._time = time;\n    sleep();\n  },\n  stop: function() {\n    if (this._call) {\n      this._call = null;\n      this._time = Infinity;\n      sleep();\n    }\n  }\n};\n\nexport function timer(callback, delay, time) {\n  var t = new Timer;\n  t.restart(callback, delay, time);\n  return t;\n}\n\nexport function timerFlush() {\n  now(); // Get the current time, if not already set.\n  ++frame; // Pretend we’ve set an alarm, if we haven’t already.\n  var t = taskHead, e;\n  while (t) {\n    if ((e = clockNow - t._time) >= 0) t._call.call(null, e);\n    t = t._next;\n  }\n  --frame;\n}\n\nfunction wake() {\n  clockNow = (clockLast = clock.now()) + clockSkew;\n  frame = timeout = 0;\n  try {\n    timerFlush();\n  } finally {\n    frame = 0;\n    nap();\n    clockNow = 0;\n  }\n}\n\nfunction poke() {\n  var now = clock.now(), delay = now - clockLast;\n  if (delay > pokeDelay) clockSkew -= delay, clockLast = now;\n}\n\nfunction nap() {\n  var t0, t1 = taskHead, t2, time = Infinity;\n  while (t1) {\n    if (t1._call) {\n      if (time > t1._time) time = t1._time;\n      t0 = t1, t1 = t1._next;\n    } else {\n      t2 = t1._next, t1._next = null;\n      t1 = t0 ? t0._next = t2 : taskHead = t2;\n    }\n  }\n  taskTail = t0;\n  sleep(time);\n}\n\nfunction sleep(time) {\n  if (frame) return; // Soonest alarm already set, or will be.\n  if (timeout) timeout = clearTimeout(timeout);\n  var delay = time - clockNow; // Strictly less than if we recomputed clockNow.\n  if (delay > 24) {\n    if (time < Infinity) timeout = setTimeout(wake, time - clock.now() - clockSkew);\n    if (interval) interval = clearInterval(interval);\n  } else {\n    if (!interval) clockLast = clock.now(), interval = setInterval(poke, pokeDelay);\n    frame = 1, setFrame(wake);\n  }\n}\n","import {Timer, now} from \"./timer.js\";\n\nexport default function(callback, delay, time) {\n  var t = new Timer, total = delay;\n  if (delay == null) return t.restart(callback, delay, time), t;\n  t._restart = t.restart;\n  t.restart = function(callback, delay, time) {\n    delay = +delay, time = time == null ? now() : +time;\n    t._restart(function tick(elapsed) {\n      elapsed += total;\n      t._restart(tick, total += delay, time);\n      callback(elapsed);\n    }, delay, time);\n  }\n  t.restart(callback, delay, time);\n  return t;\n}\n","/*\n (c) 2014-2020, Andrii Heonia\n Hull.js, a JavaScript library for concave hull generation by set of points.\n https://github.com/AndriiHeonia/hull\n*/\n\n'use strict';\n\nconst intersect = require('./intersect.js');\nconst grid = require('./grid.js');\nconst formatUtil = require('./format.js');\nconst convexHull = require('./convex.js');\n\nfunction _filterDuplicates(pointset) {\n    const unique = [pointset[0]];\n    let lastPoint = pointset[0];\n    for (let i = 1; i < pointset.length; i++) {\n        const currentPoint = pointset[i];\n        if (lastPoint[0] !== currentPoint[0] || lastPoint[1] !== currentPoint[1]) {\n            unique.push(currentPoint);\n        }\n        lastPoint = currentPoint;\n    }\n    return unique;\n}\n\nfunction _sortByX(pointset) {\n    return pointset.sort(function(a, b) {\n        return (a[0] - b[0]) || (a[1] - b[1]);\n    });\n}\n\nfunction _sqLength(a, b) {\n    return Math.pow(b[0] - a[0], 2) + Math.pow(b[1] - a[1], 2);\n}\n\nfunction _cos(o, a, b) {\n    const aShifted = [a[0] - o[0], a[1] - o[1]],\n        bShifted = [b[0] - o[0], b[1] - o[1]],\n        sqALen = _sqLength(o, a),\n        sqBLen = _sqLength(o, b),\n        dot = aShifted[0] * bShifted[0] + aShifted[1] * bShifted[1];\n\n    return dot / Math.sqrt(sqALen * sqBLen);\n}\n\nfunction _intersect(segment, pointset) {\n    for (let i = 0; i < pointset.length - 1; i++) {\n        const seg = [pointset[i], pointset[i + 1]];\n        if (segment[0][0] === seg[0][0] && segment[0][1] === seg[0][1] ||\n            segment[0][0] === seg[1][0] && segment[0][1] === seg[1][1]) {\n            continue;\n        }\n        if (intersect(segment, seg)) {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction _occupiedArea(pointset) {\n    let minX = Infinity;\n    let minY = Infinity;\n    let maxX = -Infinity;\n    let maxY = -Infinity;\n\n    for (let i = pointset.length - 1; i >= 0; i--) {\n        if (pointset[i][0] < minX) {\n            minX = pointset[i][0];\n        }\n        if (pointset[i][1] < minY) {\n            minY = pointset[i][1];\n        }\n        if (pointset[i][0] > maxX) {\n            maxX = pointset[i][0];\n        }\n        if (pointset[i][1] > maxY) {\n            maxY = pointset[i][1];\n        }\n    }\n\n    return [\n        maxX - minX, // width\n        maxY - minY  // height\n    ];\n}\n\nfunction _bBoxAround(edge) {\n    return [\n        Math.min(edge[0][0], edge[1][0]), // left\n        Math.min(edge[0][1], edge[1][1]), // top\n        Math.max(edge[0][0], edge[1][0]), // right\n        Math.max(edge[0][1], edge[1][1])  // bottom\n    ];\n}\n\nfunction _midPoint(edge, innerPoints, convex) {\n    let point = null,\n        angle1Cos = MAX_CONCAVE_ANGLE_COS,\n        angle2Cos = MAX_CONCAVE_ANGLE_COS,\n        a1Cos, a2Cos;\n\n    for (let i = 0; i < innerPoints.length; i++) {\n        a1Cos = _cos(edge[0], edge[1], innerPoints[i]);\n        a2Cos = _cos(edge[1], edge[0], innerPoints[i]);\n\n        if (a1Cos > angle1Cos && a2Cos > angle2Cos &&\n            !_intersect([edge[0], innerPoints[i]], convex) &&\n            !_intersect([edge[1], innerPoints[i]], convex)) {\n\n            angle1Cos = a1Cos;\n            angle2Cos = a2Cos;\n            point = innerPoints[i];\n        }\n    }\n\n    return point;\n}\n\nfunction _concave(convex, maxSqEdgeLen, maxSearchArea, grid, edgeSkipList) {\n    let midPointInserted = false;\n\n    for (let i = 0; i < convex.length - 1; i++) {\n        const edge = [convex[i], convex[i + 1]];\n        // generate a key in the format X0,Y0,X1,Y1\n        const keyInSkipList = edge[0][0] + ',' + edge[0][1] + ',' + edge[1][0] + ',' + edge[1][1];\n\n        if (_sqLength(edge[0], edge[1]) < maxSqEdgeLen ||\n            edgeSkipList.has(keyInSkipList)) { continue; }\n\n        let scaleFactor = 0;\n        let bBoxAround = _bBoxAround(edge);\n        let bBoxWidth;\n        let bBoxHeight;\n        let midPoint;\n        do {\n            bBoxAround = grid.extendBbox(bBoxAround, scaleFactor);\n            bBoxWidth = bBoxAround[2] - bBoxAround[0];\n            bBoxHeight = bBoxAround[3] - bBoxAround[1];\n\n            midPoint = _midPoint(edge, grid.rangePoints(bBoxAround), convex);\n            scaleFactor++;\n        }  while (midPoint === null && (maxSearchArea[0] > bBoxWidth || maxSearchArea[1] > bBoxHeight));\n\n        if (bBoxWidth >= maxSearchArea[0] && bBoxHeight >= maxSearchArea[1]) {\n            edgeSkipList.add(keyInSkipList);\n        }\n\n        if (midPoint !== null) {\n            convex.splice(i + 1, 0, midPoint);\n            grid.removePoint(midPoint);\n            midPointInserted = true;\n        }\n    }\n\n    if (midPointInserted) {\n        return _concave(convex, maxSqEdgeLen, maxSearchArea, grid, edgeSkipList);\n    }\n\n    return convex;\n}\n\nfunction hull(pointset, concavity, format) {\n    let maxEdgeLen = concavity || 20;\n\n    const points = _filterDuplicates(_sortByX(formatUtil.toXy(pointset, format)));\n\n    if (points.length < 4) {\n        return points.concat([points[0]]);\n    }\n\n    const occupiedArea = _occupiedArea(points);\n    const maxSearchArea = [\n        occupiedArea[0] * MAX_SEARCH_BBOX_SIZE_PERCENT,\n        occupiedArea[1] * MAX_SEARCH_BBOX_SIZE_PERCENT\n    ];\n\n    const convex = convexHull(points);\n    const innerPoints = points.filter(function(pt) {\n        return convex.indexOf(pt) < 0;\n    });\n\n    const cellSize = Math.ceil(1 / (points.length / (occupiedArea[0] * occupiedArea[1])));\n\n    const concave = _concave(\n        convex, Math.pow(maxEdgeLen, 2),\n        maxSearchArea, grid(innerPoints, cellSize), new Set());\n\n    if (format) {\n        return formatUtil.fromXy(concave, format);\n    } else {\n        return concave;\n    }\n}\n\nconst MAX_CONCAVE_ANGLE_COS = Math.cos(90 / (180 / Math.PI)); // angle = 90 deg\nconst MAX_SEARCH_BBOX_SIZE_PERCENT = 0.6;\n\nmodule.exports = hull;\n","function ccw(x1, y1, x2, y2, x3, y3) {           \n    const cw = ((y3 - y1) * (x2 - x1)) - ((y2 - y1) * (x3 - x1));\n    return cw > 0 ? true : cw < 0 ? false : true; // colinear\n}\n\nfunction intersect(seg1, seg2) {\n  const x1 = seg1[0][0], y1 = seg1[0][1],\n      x2 = seg1[1][0], y2 = seg1[1][1],\n      x3 = seg2[0][0], y3 = seg2[0][1],\n      x4 = seg2[1][0], y4 = seg2[1][1];\n\n    return ccw(x1, y1, x3, y3, x4, y4) !== ccw(x2, y2, x3, y3, x4, y4) && ccw(x1, y1, x2, y2, x3, y3) !== ccw(x1, y1, x2, y2, x4, y4);\n}\n\nmodule.exports = intersect;","function Grid(points, cellSize) {\n    this._cells = [];\n    this._cellSize = cellSize;\n    this._reverseCellSize = 1 / cellSize;\n\n    for (let i = 0; i < points.length; i++) {\n        const point = points[i];\n        const x = this.coordToCellNum(point[0]);\n        const y = this.coordToCellNum(point[1]);\n        if (!this._cells[x]) {\n            const array = [];\n            array[y] = [point];\n            this._cells[x] = array;\n        } else if (!this._cells[x][y]) {\n            this._cells[x][y] = [point];\n        } else {\n            this._cells[x][y].push(point);\n        }\n    }\n}\n\nGrid.prototype = {\n    cellPoints: function(x, y) { // (Number, Number) -> Array\n        return (this._cells[x] !== undefined && this._cells[x][y] !== undefined) ? this._cells[x][y] : [];\n    },\n\n    rangePoints: function(bbox) { // (Array) -> Array\n        const tlCellX = this.coordToCellNum(bbox[0]);\n        const tlCellY = this.coordToCellNum(bbox[1]);\n        const brCellX = this.coordToCellNum(bbox[2]);\n        const brCellY = this.coordToCellNum(bbox[3]);\n        const points = [];\n\n        for (let x = tlCellX; x <= brCellX; x++) {\n            for (let y = tlCellY; y <= brCellY; y++) {\n                // replaced Array.prototype.push.apply to avoid hitting stack size limit on larger arrays.\n                for (let i = 0; i < this.cellPoints(x, y).length; i++) {\n                    points.push(this.cellPoints(x, y)[i]);\n                }\n            }\n        }\n\n        return points;\n    },\n\n    removePoint: function(point) { // (Array) -> Array\n        const cellX = this.coordToCellNum(point[0]);\n        const cellY = this.coordToCellNum(point[1]);\n        const cell = this._cells[cellX][cellY];\n        let pointIdxInCell;\n\n        for (let i = 0; i < cell.length; i++) {\n            if (cell[i][0] === point[0] && cell[i][1] === point[1]) {\n                pointIdxInCell = i;\n                break;\n            }\n        }\n\n        cell.splice(pointIdxInCell, 1);\n\n        return cell;\n    },\n\n    trunc: Math.trunc || function(val) { // (number) -> number\n        return val - val % 1;\n    },\n\n    coordToCellNum: function(x) { // (number) -> number\n        return this.trunc(x * this._reverseCellSize);\n    },\n\n    extendBbox: function(bbox, scaleFactor) { // (Array, Number) -> Array\n        return [\n            bbox[0] - (scaleFactor * this._cellSize),\n            bbox[1] - (scaleFactor * this._cellSize),\n            bbox[2] + (scaleFactor * this._cellSize),\n            bbox[3] + (scaleFactor * this._cellSize)\n        ];\n    }\n};\n\nfunction grid(points, cellSize) {\n    return new Grid(points, cellSize);\n}\n\nmodule.exports = grid;","module.exports = {\n\n    toXy: function(pointset, format) {\n        if (format === undefined) {\n            return pointset.slice();\n        }\n        return pointset.map(function(pt) {\n            /*jslint evil: true */\n            const _getXY = new Function('pt', 'return [pt' + format[0] + ',' + 'pt' + format[1] + '];');\n            return _getXY(pt);\n        });\n    },\n\n    fromXy: function(pointset, format) {\n        if (format === undefined) {\n            return pointset.slice();\n        }\n        return pointset.map(function(pt) {\n            /*jslint evil: true */\n            const _getObj = new Function('pt', 'const o = {}; o' + format[0] + '= pt[0]; o' + format[1] + '= pt[1]; return o;');\n            return _getObj(pt);\n        });\n    }\n\n}","function _cross(o, a, b) {\n    return (a[0] - o[0]) * (b[1] - o[1]) - (a[1] - o[1]) * (b[0] - o[0]);\n}\n\nfunction _upperTangent(pointset) {\n    const lower = [];\n    for (let l = 0; l < pointset.length; l++) {\n        while (lower.length >= 2 && (_cross(lower[lower.length - 2], lower[lower.length - 1], pointset[l]) <= 0)) {\n            lower.pop();\n        }\n        lower.push(pointset[l]);\n    }\n    lower.pop();\n    return lower;\n}\n\nfunction _lowerTangent(pointset) {\n    const reversed = pointset.reverse(),\n        upper = [];\n    for (let u = 0; u < reversed.length; u++) {\n        while (upper.length >= 2 && (_cross(upper[upper.length - 2], upper[upper.length - 1], reversed[u]) <= 0)) {\n            upper.pop();\n        }\n        upper.push(reversed[u]);\n    }\n    upper.pop();\n    return upper;\n}\n\n// pointset has to be sorted by X\nfunction convex(pointset) {\n    const upper = _upperTangent(pointset),\n          lower = _lowerTangent(pointset);\n    const convex = lower.concat(upper);\n    convex.push(pointset[0]);  \n    return convex;  \n}\n\nmodule.exports = convex;\n"],"sourceRoot":""}