{"version":3,"sources":["components/CanvasIndustrySpaceCustom.js","App.js","index.js"],"names":["data","JSON","parse","rootNodeRef","useRef","useEffect","current","rootEl","root","d3","height","window","innerHeight","width","innerWidth","allXValues","allYValues","nodes","forEach","graphics","x","y","push","xRange","yRange","xScale","domain","range","yScale","canvas","append","attr","node","context","getContext","simulation","force","strength","id","d","transform","tempData","hoveredNode","undefined","dragsubject","invertX","invertY","i","length","nodeX","nodeY","dx","dy","radius","applyX","applyY","simulationUpdate","hoveredId","save","clearRect","translate","scale","k","edges","beginPath","moveTo","source","lineTo","target","strokeStyle","stroke","arc","Math","PI","fillStyle","color","fill","style","cursor","console","log","restore","call","scaleExtent","on","alert","links","initGraph","createForceGraph","ref","App","CanvasIndustrySpaceCustom","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.54cfd608.chunk.js","sourcesContent":["import React, {useEffect, useRef} from 'react';\nimport * as d3 from 'd3';\nimport raw from 'raw.macro';\n\nconst data = JSON.parse(raw('../data/industry-space.json'));\n\nconst createForceGraph = (rootEl, data) => {\n  const root = d3.select(rootEl);\n\n  const radius = 3;\n\n  const height = window.innerHeight;\n  const width =  window.innerWidth;\n\n  const allXValues = [];\n  const allYValues = [];\n  data.nodes.forEach(({graphics: {x, y}}) => {\n    allXValues.push(x);\n    allYValues.push(y);\n  });\n\n  const xRange = d3.extent(allXValues);\n  const yRange = d3.extent(allYValues);\n\n  const xScale = d3.scaleLinear()\n    .domain(xRange)\n    .range([ 0 + 100, width - 100 ]);\n\n  const yScale = d3.scaleLinear()\n    .domain(yRange)\n    .range([ height - 100, 0 + 100]);\n\n\n\n  const canvas = root.append('canvas')\n    .attr('width', width + 'px')\n    .attr('height', height + 'px')\n    .node();\n\n  const context = canvas.getContext('2d');\n\n  const simulation = d3.forceSimulation()\n                .force(\"center\", d3.forceCenter(width / 2, height / 2))\n                .force(\"charge\", d3.forceManyBody().strength(-50))\n                .force(\"link\", d3.forceLink().strength(1).id(function(d) { return d.id; }))\n\n  let transform = d3.zoomIdentity;\n\n  initGraph(data)\n\n  function initGraph(tempData){\n\n    function zoomed() {\n      transform = d3.event.transform;\n      simulationUpdate();\n    }\n\n    let hoveredNode = undefined;\n    \n    d3.select(canvas)\n      .call(d3.zoom().scaleExtent([1 / 10, 8]).on(\"zoom\", zoomed))\n      .on('mousemove', function() {\n        hoveredNode = dragsubject();\n        simulationUpdate();\n      })\n      .on('click', function() {\n        const node = dragsubject();\n        if (node) {\n          alert('Clicked ' + node.id);\n        }\n      })\n\n\n\n    function dragsubject() {\n      const x = transform.invertX(d3.event.x);\n      const y = transform.invertY(d3.event.y);\n      for (let i = tempData.nodes.length - 1; i >= 0; --i) {\n        const node = tempData.nodes[i];\n        let nodeX = xScale(node.graphics.x);\n        let nodeY = yScale(node.graphics.y);\n        const dx = x - nodeX;\n        const dy = y - nodeY;\n\n        if (dx * dx + dy * dy < radius * radius) {\n\n          nodeX =  transform.applyX(nodeX);\n          nodeY = transform.applyY(nodeY);\n\n          return node;\n        }\n      }\n    }\n\n    simulation.nodes(tempData.nodes)\n              .on(\"tick\", simulationUpdate);\n\n    simulation.force(\"link\")\n              .links(tempData.edges);\n\n\n\n    function simulationUpdate() {\n      const hoveredId = hoveredNode && hoveredNode.id ? hoveredNode.id : undefined;\n\n      context.save();\n\n      context.clearRect(0, 0, width, height);\n      context.translate(transform.x, transform.y);\n      context.scale(transform.k, transform.k);\n\n      tempData.edges.forEach(function(d) {\n        context.beginPath();\n        context.moveTo(xScale(d.source.graphics.x), yScale(d.source.graphics.y));\n        context.lineTo(xScale(d.target.graphics.x), yScale(d.target.graphics.y));\n        context.strokeStyle = hoveredId === d.source.id || hoveredId === d.target.id\n          ? 'rgba(0, 0, 0, 0.5)' : 'rgba(0, 0, 0, 0.04)';\n        context.stroke();\n      });\n\n      // Draw the nodes\n      tempData.nodes.forEach(function(d, i) {\n        context.beginPath();\n        context.arc(xScale(d.graphics.x), yScale(d.graphics.y), radius, 0, 2 * Math.PI, true);\n        context.fillStyle = d.color\n        context.fill();\n      });\n\n      if (hoveredNode) {\n        rootEl.style.cursor = 'pointer';\n        context.beginPath();\n        context.arc(xScale(hoveredNode.graphics.x), yScale(hoveredNode.graphics.y), radius, 0, 2 * Math.PI, true);\n        console.log(hoveredNode)\n        context.fillStyle = hoveredNode.color\n        context.fill();\n        context.strokeStyle = 'black';\n        context.stroke();\n      } else {\n        rootEl.style.cursor = 'move';\n      }\n\n      context.restore();\n    }\n  }\n\n\n}\n\nexport default () => {\n  const rootNodeRef = useRef(null);\n\n  useEffect(() => {\n    let rootEl = null;\n    if (rootNodeRef && rootNodeRef.current) {\n      rootEl = rootNodeRef.current;\n      createForceGraph(rootEl, data);\n    }\n  }, [rootNodeRef]);\n\n  return (\n    <div ref={rootNodeRef} width={500} height={500} />\n  );\n}\n","import React from 'react'\nimport CanvasIndustrySpaceCustom from './components/CanvasIndustrySpaceCustom';\n\nconst App = () => {\n  return (\n    <div>\n      <CanvasIndustrySpaceCustom />\n    </div>\n  );\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}