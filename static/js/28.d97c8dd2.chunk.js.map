{"version":3,"sources":["components/CanvasIndustrySpaceUMapProximityEdgesThreshold.js","pages/IndustrySpaceUMapEdgesThreshold.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../../node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","sector-legend.png","components/BasicLegend.js"],"names":["data","JSON","parse","proximityNodes","naicsData","colorMap","id","color","rootNodeRef","useRef","useEffect","rootEl","current","root","d3","height","window","innerHeight","width","innerWidth","smallerSize","padding","widthMargin","heightMargin","rangeWidth","rangeHeight","allXValues","allYValues","nodes","forEach","x","y","push","radiusAdjuster","map","n","radius","Math","random","industry6Digit","find","code","toString","Error","naics_id","topLevelParentId","datum","parent_id","parseInt","console","error","xRange","yRange","xScale","domain","range","yScale","canvas","append","attr","node","context","getContext","simulation","force","strength","d","proximity","velocityDecay","k","alpha","tick","transform","tempData","zoom","scaleExtent","on","simulationUpdate","hoveredNode","undefined","highlightedNode","primaryNodes","secondaryNodes","tertiaryNodes","quarternaryNodes","canvasEl","dragsubject","invertX","invertY","i","length","nodeX","nodeY","dx","dy","applyX","applyY","highlightedId","save","clearRect","translate","scale","beginPath","arc","PI","fillStyle","polished","fill","style","cursor","strokeStyle","stroke","restore","call","event","trg","node2","allEdgeXValues","allEdgeYValues","xBounds","yBounds","bounds","max","min","transition","duration","links","edges","initGraph","createForceGraph","innerHTML","ref","_arrayLikeToArray","arr","len","arr2","Array","_unsupportedIterableToArray","o","minLen","Object","prototype","slice","constructor","name","from","test","_defineProperty","obj","key","value","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","apply","_objectSpread2","target","arguments","source","getOwnPropertyDescriptors","defineProperties","_toConsumableArray","isArray","arrayLikeToArray","iter","Symbol","iterator","unsupportedIterableToArray","TypeError","module","exports","Root","styled","div","Legend","img","tableLayout","paddingRight","src","require"],"mappings":"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","file":"static/js/28.d97c8dd2.chunk.js","sourcesContent":["import React, {useEffect, useRef} from 'react';\nimport * as d3 from 'd3';\nimport raw from 'raw.macro';\nimport * as polished from 'polished';\n\nconst minExpectedScreenSize = 1020;\n\n// const data = JSON.parse(raw('../data/industry-space-with-start-positions.json'));\nconst data = JSON.parse(raw('../data/umap-custom-2.json'));\nconst proximityNodes = JSON.parse(raw('../data/proximity.json'));\nconst naicsData = JSON.parse(raw('../data/naics_2017.json'));\n\nconst colorMap = [\n  { id: '0', color: '#A973BE' },\n  { id: '1', color: '#F1866C' },\n  { id: '2', color: '#FFC135' },\n  { id: '3', color: '#93CFD0' },\n  { id: '4', color: '#488098' },\n  { id: '5', color: '#77C898' },\n  { id: '6', color: '#6A6AAD' },\n  { id: '7', color: '#D35162' },\n  { id: '8', color: '#F28188' },\n]\n\nconst createForceGraph = (rootEl, data) => {\n  const root = d3.select(rootEl);\n\n  const height = window.innerHeight;\n  const width =  window.innerWidth;\n\n  const smallerSize = width < height ? width : height;\n  const padding = smallerSize * 0.1;\n  const widthMargin = (width - smallerSize) / 2;\n  const heightMargin = (height - (smallerSize * 0.9)) / 2;\n  const rangeWidth = width - padding - widthMargin;\n  const rangeHeight = height - padding - heightMargin;\n\n  const allXValues = [];\n  const allYValues = [];\n  data.nodes.forEach(({x, y}) => {\n    allXValues.push(x);\n    allYValues.push(y);\n  });\n\n  const radiusAdjuster = smallerSize / minExpectedScreenSize;\n\n  data.nodes = data.nodes.map(n => {\n    let radius = Math.random() * 6;\n    radius = radius < 2.5 ? 2.5 * radiusAdjuster : radius * radiusAdjuster;\n    // const radius = 2.5;\n    const industry6Digit = naicsData.find(({code}) => n.id.toString() === code);\n    if (!industry6Digit) {\n      throw new Error('undefined industry');\n      \n    }\n    const naics_id = industry6Digit.naics_id;\n    let topLevelParentId = naics_id.toString();\n    let current = naicsData.find(datum => datum.naics_id === naics_id);\n    while(current && current.parent_id !== null) {\n    // eslint-disable-next-line\n      current = naicsData.find(datum => datum.naics_id === current.parent_id);\n      if (current && current.parent_id !== null) {\n        topLevelParentId = current.parent_id.toString();\n      } else if (current && current.naics_id !== null) {\n        topLevelParentId = current.naics_id.toString();\n      }\n    }\n    if (parseInt(topLevelParentId, 10) > 8) {\n      console.error(current);\n      throw new Error('Parent out of range')\n    }\n    const {color} = colorMap.find(({id}) => id === topLevelParentId);\n    return {...n, radius, color}\n  })\n\n  const xRange = d3.extent(allXValues);\n  const yRange = d3.extent(allYValues);\n\n  const xScale = d3.scaleLinear()\n    .domain(xRange)\n    .range([0 + padding + widthMargin, rangeWidth]);\n\n  const yScale = d3.scaleLinear()\n    .domain(yRange)\n    .range([ rangeHeight, 0 + padding + heightMargin]);\n\n  const canvas = root.append('canvas')\n    .attr('width', width + 'px')\n    .attr('height', height + 'px')\n    .node();\n\n  const context = canvas.getContext('2d');\n\n\n  const simulation = d3.forceSimulation()\n                .force(\"center\", d3.forceCenter(rangeWidth / 1.8, rangeHeight / 1.8))\n                .force(\"charge\", d3.forceManyBody().strength(-10))\n                .force(\"collision\", d3.forceCollide().radius(function(d) {\n                  return (d.radius * 1.25) * (minExpectedScreenSize / smallerSize);\n                }))\n                .force(\"link\", d3.forceLink().strength(d => d.proximity).id(d => d.id))\n                .velocityDecay(0.96)\n  let k = 0;\n  while ((simulation.alpha() > 1e-2) && (k < 150)) {\n      simulation.tick();\n      k = k + 1;\n  }\n\n  let transform = d3.zoomIdentity;\n\n  initGraph(data)\n\n  function initGraph(tempData){\n\n    function zoomed() {\n      transform = d3.event.transform;\n      simulationUpdate();\n    }\n\n    const zoom = d3.zoom().scaleExtent([1 / 10, 8]).on(\"zoom\", zoomed);\n\n    let hoveredNode = undefined;\n    let highlightedNode = undefined;\n    let primaryNodes = [];\n    let secondaryNodes = [];\n    let tertiaryNodes = [];\n    let quarternaryNodes = [];\n    \n    const canvasEl = d3.select(canvas);\n    canvasEl\n      .call(zoom)\n      .on('mousemove', function() {\n        hoveredNode = dragsubject();\n        simulationUpdate();\n      })\n      .on('click', function(event) {\n        const node = dragsubject();\n        highlightedNode = node;\n        if (node) {\n          // nodes are adjusted by 1 to account for this node always being the closest\n          primaryNodes = [];\n          secondaryNodes = [];\n          tertiaryNodes = [];\n          quarternaryNodes = [];\n          proximityNodes[node.id].forEach(({trg, proximity}, i) => {\n            const node2 = tempData.nodes.find(n => n.id === trg);\n            if (node2) {\n              if (i < 8) {\n                primaryNodes.push({...node2, proximity});\n              } else if (i < 24) {\n                secondaryNodes.push({...node2, proximity});\n              } else if (i < 48) {\n                tertiaryNodes.push({...node2, proximity});\n              } else {\n                quarternaryNodes.push({...node2, proximity});\n              }\n            }\n          });\n          const allEdgeXValues = [];\n          const allEdgeYValues = [];\n          [node, ...primaryNodes].forEach(n => {\n            allEdgeXValues.push(xScale(n.x));\n            allEdgeYValues.push(yScale(n.y));\n          });\n\n          const xBounds = d3.extent(allEdgeXValues);\n          const yBounds = d3.extent(allEdgeYValues);\n          const bounds = [\n            [xBounds[0], yBounds[0]],\n            [xBounds[1], yBounds[1]],\n          ];\n          const dx = bounds[1][0] - bounds[0][0];\n          const dy = bounds[1][1] - bounds[0][1];\n          const x = (bounds[0][0] + bounds[1][0]) / 2;\n          const y = (bounds[0][1] + bounds[1][1]) / 2;\n          const scale = Math.max(1, Math.min(8, 0.9 / Math.max(dx / rangeWidth, dy / rangeHeight)));\n          const translate = [width / 2 - scale * x, height / 2 - scale * y];\n\n          canvasEl.transition()\n              .duration(500)\n              .call( zoom.transform, d3.zoomIdentity.translate(translate[0],translate[1]).scale(scale));\n\n        }\n        simulationUpdate();\n      })\n\n\n\n    function dragsubject() {\n      const x = transform.invertX(d3.event.x);\n      const y = transform.invertY(d3.event.y);\n      for (let i = tempData.nodes.length - 1; i >= 0; --i) {\n        const node = tempData.nodes[i];\n        let nodeX = xScale(node.x);\n        let nodeY = yScale(node.y);\n        const dx = x - nodeX;\n        const dy = y - nodeY;\n\n        if (dx * dx + dy * dy < node.radius * node.radius) {\n\n          nodeX =  transform.applyX(nodeX);\n          nodeY = transform.applyY(nodeY);\n\n          return node;\n        }\n      }\n    }\n\n    simulation.nodes(tempData.nodes)\n              .on(\"tick\", simulationUpdate);\n\n    simulation.force(\"link\")\n              .links(tempData.edges);\n\n\n\n    function simulationUpdate() {\n      // const hoveredId = hoveredNode && hoveredNode.id ? hoveredNode.id : undefined;\n      const highlightedId = highlightedNode && highlightedNode.id ? highlightedNode.id : undefined;\n      // const linkedEdges = tempData.edges.filter(({source, target}) =>\n      //     source.id === hoveredId || target.id === hoveredId ||\n      //     source.id === highlightedId || target.id === highlightedId)\n\n      context.save();\n\n      context.clearRect(0, 0, width, height);\n      context.translate(transform.x, transform.y);\n      context.scale(transform.k, transform.k);\n\n      // tempData.edges.forEach(function(d) {\n      //   context.beginPath();\n      //   context.moveTo(xScale(d.source.x), yScale(d.source.y));\n      //   context.lineTo(xScale(d.target.x), yScale(d.target.y));\n      //   if (highlightedId) {\n      //     context.strokeStyle = '#f9f9f9';\n      //   } else {\n      //     context.strokeStyle = '#e6e6e6';\n      //   }\n      //   context.stroke();\n      // });\n\n      // Draw the nodes\n      tempData.nodes.forEach(function(d, i) {\n        context.beginPath();\n        context.arc(xScale(d.x), yScale(d.y), d.radius, 0, 2 * Math.PI, true);\n        context.fillStyle = highlightedId === undefined ? d.color : polished.rgba(d.color, 0.035);\n        context.fill();\n      });\n\n      // const linkedNodeIds = [];\n      // linkedEdges.forEach(function(d) {\n      //   if (!linkedNodeIds.includes(({id}) => d.source.id)) {\n      //     linkedNodeIds.push(d.source);\n      //   }\n      //   if (!linkedNodeIds.includes(({id}) => d.target.id)) {\n      //     linkedNodeIds.push(d.target);\n      //   }\n      //   // context.beginPath();\n      //   // context.moveTo(xScale(d.source.x), yScale(d.source.y));\n      //   // context.lineTo(xScale(d.target.x), yScale(d.target.y));\n      //   // context.strokeStyle = '#afafaf';\n      //   // context.stroke();\n      // });\n\n      // linkedNodeIds.forEach(function(d, i) {\n      //   if (d) {\n      //     context.beginPath();\n      //     context.arc(xScale(d.x), yScale(d.y), d.radius, 0, 2 * Math.PI, true);\n      //     context.fillStyle = d.color;\n      //     context.fill();\n      //     context.strokeStyle = '#afafaf';\n      //     context.stroke();\n      //   }\n      // });\n\n\n      if (hoveredNode) {\n        rootEl.style.cursor = 'pointer';\n        context.beginPath();\n        context.arc(xScale(hoveredNode.x), yScale(hoveredNode.y), hoveredNode.radius, 0, 2 * Math.PI, true);\n        context.fillStyle = hoveredNode.color\n        context.fill();\n        context.strokeStyle = 'black';\n        context.stroke();\n      } else {\n        rootEl.style.cursor = 'move';\n      }\n      if (highlightedNode) {\n        context.beginPath();\n        context.arc(xScale(highlightedNode.x), yScale(highlightedNode.y), highlightedNode.radius, 0, 2 * Math.PI, true);\n        context.fillStyle = highlightedNode.color\n        context.fill();\n        context.strokeStyle = 'black';\n        context.stroke();\n      }\n      if (primaryNodes && primaryNodes.length) {\n        primaryNodes.forEach(function(d, i) {\n          context.beginPath();\n          context.arc(xScale(d.x), yScale(d.y), d.radius, 0, 2 * Math.PI, true);\n          context.fillStyle = polished.rgba(d.color, 0.8);\n          context.fillStyle = polished.rgba(d.color, d.proximity * 100);\n          context.fill();\n        });\n      }\n      if (secondaryNodes && secondaryNodes.length) {\n        secondaryNodes.forEach(function(d, i) {\n          context.beginPath();\n          context.arc(xScale(d.x), yScale(d.y), d.radius, 0, 2 * Math.PI, true);\n          context.fillStyle = polished.rgba(d.color, 0.5);\n          context.fillStyle = polished.rgba(d.color, d.proximity * 100);\n          context.fill();\n        });\n      }\n      if (tertiaryNodes && tertiaryNodes.length) {\n        tertiaryNodes.forEach(function(d, i) {\n          context.beginPath();\n          context.arc(xScale(d.x), yScale(d.y), d.radius, 0, 2 * Math.PI, true);\n          context.fillStyle = polished.rgba(d.color, 0.3);\n          context.fill();\n        });\n      }\n      if (quarternaryNodes && quarternaryNodes.length) {\n        quarternaryNodes.forEach(function(d, i) {\n          context.beginPath();\n          context.arc(xScale(d.x), yScale(d.y), d.radius, 0, 2 * Math.PI, true);\n          context.fillStyle = polished.rgba(d.color, 0.085);\n          context.fill();\n        });\n      }\n\n      context.restore();\n    }\n  }\n}\n\nexport default () => {\n  const rootNodeRef = useRef(null);\n\n  useEffect(() => {\n    let rootEl = null;\n    if (rootNodeRef && rootNodeRef.current) {\n      rootEl = rootNodeRef.current;\n      createForceGraph(rootEl, data);\n    }\n    return (() => {\n      if (rootEl) {\n        rootEl.innerHTML = '';\n      }\n    })\n  }, [rootNodeRef]);\n\n  return (\n    <div>\n      <div ref={rootNodeRef} />\n    </div>\n  );\n}\n","import React from 'react'\nimport CanvasIndustrySpace from '../components/CanvasIndustrySpaceUMapProximityEdgesThreshold';\nimport Legend from '../components/BasicLegend';\n\nexport default () => {\n  return (\n    <div>\n      <CanvasIndustrySpace />\n      <Legend />\n    </div>\n  );\n}\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(n);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","module.exports = __webpack_public_path__ + \"static/media/sector-legend.a4fd20af.png\";","import React from 'react';\nimport styled from 'styled-components/macro';\n\nconst Root = styled.div`\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  pointer-events: none;\n  z-index: 100;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-sizing:  border-box;\n  padding-left: 2rem;\n  padding-bottom: 2rem;\n`;\n\nconst Legend = styled.img`\n  width: 100%;\n  max-width: 800px;\n`;\n\nexport default ({tableLayout}) => {\n  return (\n    <Root\n      style={{paddingRight: tableLayout ? 550 : undefined}}\n    >\n      <Legend src={require('../sector-legend.png')} />\n    </Root>\n  );\n}\n"],"sourceRoot":""}